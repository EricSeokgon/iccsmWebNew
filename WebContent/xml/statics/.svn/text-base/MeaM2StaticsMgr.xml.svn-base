<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="#c6dce1" Height="711" Id="MeaM2StaticsMgr" Left="8" OnActivate="fnForm_Activate" OnLoadCompleted="fnForm_Loaded" PidAttrib="7" Title="MeaM2StaticsMgr" Top="8" Ver="1.0" Width="1024" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="dsV_PT_R_STATICS">
				<Contents>
					<colinfo id="susu" size="256" summ="default" type="STRING"/>
					<colinfo id="icic" size="256" summ="default" type="STRING"/>
					<colinfo id="gggg" size="256" summ="default" type="STRING"/>
					<colinfo id="gwgw" size="256" summ="default" type="STRING"/>
					<colinfo id="djdj" size="256" summ="default" type="STRING"/>
					<colinfo id="cncn" size="256" summ="default" type="STRING"/>
					<colinfo id="cbcb" size="256" summ="default" type="STRING"/>
					<colinfo id="bsbs" size="256" summ="default" type="STRING"/>
					<colinfo id="usus" size="256" summ="default" type="STRING"/>
					<colinfo id="gngn" size="256" summ="default" type="STRING"/>
					<colinfo id="dgdg" size="256" summ="default" type="STRING"/>
					<colinfo id="gbgb" size="256" summ="default" type="STRING"/>
					<colinfo id="gjgj" size="256" summ="default" type="STRING"/>
					<colinfo id="jnjn" size="256" summ="default" type="STRING"/>
					<colinfo id="jbjb" size="256" summ="default" type="STRING"/>
					<colinfo id="jjjj" size="256" summ="default" type="STRING"/>
					<record>
						<bsbs>부산</bsbs>
						<cbcb>충북</cbcb>
						<cncn>충남</cncn>
						<dgdg>대구</dgdg>
						<djdj>대전</djdj>
						<gbgb>경북</gbgb>
						<gggg>경기</gggg>
						<gjgj>광주</gjgj>
						<gngn>전남</gngn>
						<gwgw>강원</gwgw>
						<icic>인천</icic>
						<jbjb>전북</jbjb>
						<jjjj>제주</jjjj>
						<jnjn>전남</jnjn>
						<susu>서울</susu>
						<usus>울산</usus>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPT_M_MASTER">
				<Contents>
					<colinfo id="M_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="SIDO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SIDO_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="M_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="VIOL_CONT_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="72" Id="Image0" ImageID="form_top" Left="8" TabOrder="8" Top="77" Width="816"></Image>
		<Div BKColor="#c6dce1" Height="54" Id="divButtonBar" Left="8" TabOrder="1" Text="Div0" Top="18" Url="base::frmButtonBar.xml" Width="820">
			<Contents></Contents>
		</Div>
		<Image Height="424" Id="Image1" ImageID="form_bg" Left="8" TabOrder="2" Top="149" Width="817"></Image>
		<Image Height="73" Id="Image2" ImageID="form_bottom" Left="8" TabOrder="3" Top="573" Width="816"></Image>
		<Image Height="30" Id="Image5" ImageID="form_w_top" Left="16" TabOrder="4" Top="139" Width="798"></Image>
		<Image Height="447" Id="Image6" ImageID="form_w_bg488" Left="16" OnClick="Image6_OnClick" TabOrder="5" Top="168" Width="798"></Image>
		<Image Height="30" Id="Image7" ImageID="form_w_bottom" Left="16" TabOrder="6" Top="605" Width="798"></Image>
		<Grid BindDataset="dsV_PT_R_STATICS" BkColor2="#f0f0f0" BkSelColor="#787878" BoldHead="true" Border="HalfFlat" BorderColor="lightslategray" Bottom="584" ButtonColor="user0" Color="#666666" Editable="TRUE" Enable="true" EndLineColor="#999999" Face3dColor="#999999" HeadBorder="Flat" HeadHeight="20" Height="32" Id="grdList" InputPanel="FALSE" Left="24" LineColor="user9" OnCellClick="fnGridCellCheck" OnCellDBLClick="fnGridDouble_Click" OnHeadClick="fnGridHead_Click" Right="800" SelColor="white" ShadowColor="#999999" Style="grid_title" TabOrder="7" TabStop="true" Top="552" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="776">
			<contents>
				<format id="Default">
					<columns>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
						<col width="47"/>
					</columns>
					<body>
						<cell col="0" colid="susu" combodataset="dsV_PT_R_STATICS" display="text"/>
						<cell col="1" colid="icic" display="text"/>
						<cell col="2" colid="gggg" display="text"/>
						<cell col="3" colid="gwgw" display="text"/>
						<cell col="4" colid="djdj" display="text"/>
						<cell col="5" colid="cncn" display="text"/>
						<cell col="6" colid="cbcb" display="text"/>
						<cell col="7" colid="bsbs" display="text"/>
						<cell col="8" colid="usus" display="text"/>
						<cell col="9" colid="gngn" display="text"/>
						<cell col="10" colid="dgdg" display="text"/>
						<cell col="11" colid="gbgb" display="text"/>
						<cell col="12" colid="gjgj" display="text"/>
						<cell col="13" colid="jnjn" display="text"/>
						<cell col="14" colid="jbjb" display="text"/>
						<cell col="15" colid="jjjj" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<EXOZViewer50 Bottom="536" Height="386" Id="EXOZViewer500" Left="27" Right="800" Top="150" Width="773"></EXOZViewer50>
	</Form>
	<Script><![CDATA[/*
1. 파일명 : MeaMcomtaticsMgr.xml
2. 작성일 : 2009-05-17
3. 작성자 : Y.D. JEOUNG
4. 기  능 : 위법업체 영업정지 처분 연간 통계
5. 변경이력
  가. 2009-05-17 최초작성 (Y.D. JEOUNG)
*/

#include "UserLib::CommonJs.js"

var _vSIDO_CODE;
//////////////////////////////////////////////////////////////////
// Form 이벤트
//////////////////////////////////////////////////////////////////
function fnForm_Loaded(obj)
{
	//검색일자를 일주일전으로 초기화
	//scDATE1.Value = AddDate(Today(), -7);
	global.gv_WorkFlag = global.gv_INQUIRY;
	fnInitButtonBar();
	divButtonBar.Image1.text = space(2) + "위법업체 영업정지 처분 연간 통계";
}

function fnForm_Activate(obj)
{
	global.g_activeFrm = this.Id;
}

//////////////////////////////////////////////////////////////////
// 공통기능
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnInitButtonBar
 2. 기  능 : 화면상단 버튼상태 설정
 3. Params 
    없음
 4. Return
    없음
*/
function fnInitButtonBar()
{	
	if (global.gv_WorkFlag == global.gv_INQUIRY)
	{
		fnAllControlState(true, this);
	
		divButtonBar.btnInsert.enable = false;
		divButtonBar.btnModify.enable = false;
		divButtonBar.btnRemove.enable = false;
		
		divButtonBar.btnSave.enable = false;
		divButtonBar.btnReport.enable = true;
		divButtonBar.btnExcel.enable = true;
		
		fnTablesBinding();
	}
	else if (global.gv_WorkFlag == global.gv_INSERT)
	{
		fnAllControlState(true, this);
		
		divButtonBar.btnInsert.enable = false;
		divButtonBar.btnModify.enable = false;
		divButtonBar.btnRemove.enable = false;
		
		divButtonBar.btnSave.enable = false;
		divButtonBar.btnReport.enable = true;
		divButtonBar.btnExcel.enable = true;
	}
	else
	{
		divButtonBar.btnInsert.enable = false;
		divButtonBar.btnModify.enable = false;
		divButtonBar.btnRemove.enable = false;
		
		divButtonBar.btnSave.enable = false;
		divButtonBar.btnReport.enable = true;
		divButtonBar.btnExcel.enable = true;
	}
	divButtonBar.btnList.enable = false;
}

/**
 1. 함수명 : fnTablesBinding
 2. 기  능 : 검색조건에 대한 검색
 3. Params 
    없음
 4. Return
    없음
*/
function fnTablesBinding()
{
	var sArgs = "scSIDO_CODE="+'susu'; //"scDATE1=" + quote(this.scDATE1.Value);
	//sArgs += " scDATE2=" + quote(this.scDATE2.Value);
	//sArgs += " scRC_REGIST_NUM=" + quote(this.scRC_REGIST_NUM.Text);
	//sArgs += " scCOM_NAME=" + quote(this.scCOM_NAME.Text);
	
	var sTid = "M2_STATICS";
	var sUrl = "ICCS::statics/StaticsAction.do?cmd=MeaM2StaticsMgr";
	var sInDs = "";
	var sOutDs = "dsPT_M_MASTER=output";
	var sCallBack = "fn_CallBack";
	
	Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
}

function fn_CallBack(Svcid, sErrCode, sErrMsg) 
{
	if (sErrCode < 0) 	
	{
		alert(sErrCode + " : " + sErrMsg);
		if (svcid == "SEARCH")
		{
			alert('데이터 조회 중 오류가 발생하였습니다.');
		}
		if (svcid == "DELETE")
		{
			alert('데이터 삭제 중 오류가 발생하였습니다.');
		}
		return;
	}
	
	if (svcid == "DELETE")
	{
		alert('삭제되었습니다.');
		return;
	}
	
	if (svcid == "M2_STATICS")
	{
		_vSIDO_CODE = dsPT_M_MASTER.GetColumn(0,2);
		alert(_vSIDO_CODE);
		//frmReport_OnLoadCompleted();
	}
}


//////////////////////////////////////////////////////////////////
// 툴바 버튼 이벤트
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnToolBarButton_Click
 2. 기  능 : 툴바버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnToolBarButton_Click(obj)
{
	if (obj == divButtonBar.btnInsert) fnInsert();
	else if (obj == divButtonBar.btnModify) fnModify();
	else if (obj == divButtonBar.btnRemove) fnRemove();
	else if (obj == divButtonBar.btnSave) fnSave();
	else if (obj == divButtonBar.btnReport) fnReport();
	else if (obj == divButtonBar.btnExcel) fnExcel();
	else if (obj == divButtonBar.btnCancel) fnCancel();
	else alert('개발자오류');
}


/**
 1. 함수명 : frmReport_OnLoadCompleted
 2. 기  능 : 출력버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function frmReport_OnLoadCompleted(obj)
{
	var sParams;
 
	sParams += "viewer.namespace=\AudInnerR\ozviewer\n";
	sParams += "connection.servlet=" + global.g_ext_oz_url + "server\n";
	sParams += "connection.reportname=/Statics/RegStatics.ozr\n";
 
 
	sParams += "odi.odinames=Q)RegStatics\n";
	viewer.CreateReport(sParams);
}

/**
 1. 함수명 : fnExcel
 2. 기  능 : 엑셀버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnExcel()
{	
	fnGridToExcel(grdList, "위법업체 영업정지 처분 연간 통계");
}

//////////////////////////////////////////////////////////////////
// 검색 버튼 이벤트
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnSearchButton_Click
 2. 기  능 : 검색버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnSearchButton_Click(obj)
{
	fnTablesBinding();
}

//////////////////////////////////////////////////////////////////
// Key Down 관련 이벤트
//////////////////////////////////////////////////////////////////
function fnKey_Down(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	if(nChar == "81" && bControl == true) fnTablesBinding();
	else if(nChar == "49" && bControl == true) fnInsert();
	else if(nChar == "50" && bControl == true) fnModify();
	else if(nChar == "51" && bControl == true) fnRemove();
	else if(nChar == "83" && bControl == true) fnSave();
	//else if(nChar == "55" && bControl == true) fnSave();
	else if(nChar == "88" && bControl == true) Close();
	else if(nChar == "80" && bControl == true) fnReport();
}

//////////////////////////////////////////////////////////////////
// Grid 관련 이벤트
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnGridDouble_Click
 2. 기  능 : Grid Cell 더블크릭 이벤트 핸들러
 3. Params 
    @obj : 이벤트 오브젝트
    @nRow : 선택된 Row Index
    @nCell : 선택된 Cell Index
    @nX
    @nY
    @nPivotIndex
 4. Return
    없음
*/


function fnGridCellCheck(obj, nCell, sCol)
{
	nCell = grdList.GetClickedCell();
	_vSIDO_CODE = grdList.GetCellProp("body",nCell,"colid");
	alert(_vSIDO_CODE);
	
}

]]></Script>
</Window>