<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="#c6dce1" Height="711" Id="UBReceiptMgrC" Left="8" OnDeactivate="fn_OnDeactivate" OnKeyDown="fnKey_Down" OnLoadCompleted="fnForm_Loaded" PidAttrib="7" Title="사용전검사&#32;접수관리" Top="8" Ver="1.0" Width="1024" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_PT_UB_USEBEFORE">
				<Contents>
					<colinfo id="SIDO_CODE" size="256" type="STRING"/>
					<colinfo id="SIGUNGU_CODE" size="256" type="STRING"/>
					<colinfo id="APPLPER_NM" size="256" type="STRING"/>
					<colinfo id="APPLPER_REP" size="256" type="STRING"/>
					<colinfo id="APPLPER_POSTNUM" size="256" type="STRING"/>
					<colinfo id="APPLPER_ADDR" size="256" type="STRING"/>
					<colinfo id="APPLPER_DETAILADDR" size="256" type="STRING"/>
					<colinfo id="APPLPER_TELNUM" size="256" type="STRING"/>
					<colinfo id="OPE_NAME" size="256" type="STRING"/>
					<colinfo id="OPE_REP" size="256" type="STRING"/>
					<colinfo id="OPE_TELNUM" size="256" type="STRING"/>
					<colinfo id="COI_WRT_NUM" size="256" type="STRING"/>
					<colinfo id="OPE_POSTNUM" size="256" type="STRING"/>
					<colinfo id="OPE_ADDR" size="256" type="STRING"/>
					<colinfo id="OPE_DETAILADDR" size="256" type="STRING"/>
					<colinfo id="INSP_SPOT_NM" size="256" type="STRING"/>
					<colinfo id="INSP_SPOT_POSTNUM" size="256" type="STRING"/>
					<colinfo id="INSP_SPOT_ADDR" size="256" type="STRING"/>
					<colinfo id="INSP_SPOT_DETAILADDR" size="256" type="STRING"/>
					<colinfo id="PLANER_NM" size="256" type="STRING"/>
					<colinfo id="WORK_ITEM" size="256" type="STRING"/>
					<colinfo id="RECV_DT" size="256" type="STRING"/>
					<colinfo id="AREA" size="256" type="STRING"/>
					<colinfo id="NUM_FL" size="256" type="STRING"/>
					<colinfo id="USE" size="256" type="STRING"/>
					<colinfo id="INSP_APPL_WORK" size="256" type="STRING"/>
					<colinfo id="INSP_APPL_DT" size="256" type="STRING"/>
					<colinfo id="INSP_DT" size="256" type="STRING"/>
					<colinfo id="INSP_FEE" size="256" type="STRING"/>
					<colinfo id="INSPER_NM" size="256" type="STRING"/>
					<colinfo id="INSPER_POSI" size="256" type="STRING"/>
					<colinfo id="JUDGM" size="256" type="STRING"/>
					<colinfo id="PLAN_CONFIRM_YN" size="256" type="STRING"/>
					<colinfo id="SW_BEF_REPO_DELINUM" size="256" type="STRING"/>
					<colinfo id="SW_DT" size="256" type="STRING"/>
					<colinfo id="EW_DT" size="256" type="STRING"/>
					<colinfo id="INSP_WISH_YMD" size="256" type="STRING"/>
					<colinfo id="OFFI_TELNUM" size="256" type="STRING"/>
					<colinfo id="OFFI_NM" size="256" type="STRING"/>
					<colinfo id="USEBEFINSP_DELINUM" size="256" type="STRING"/>
					<colinfo id="SUV" size="256" type="STRING"/>
					<colinfo id="REMARK" size="256" type="STRING"/>
					<colinfo id="NET_RECV_YN" size="256" type="STRING"/>
					<colinfo id="PLAN_CONFIRM_REMARK" size="256" type="STRING"/>
					<colinfo id="NAPPL_YN" size="256" type="STRING"/>
					<colinfo id="NAPPL_CAUSE" size="256" type="STRING"/>
					<colinfo id="DOC_INSP_REMARK" size="256" type="STRING"/>
					<colinfo id="CIV_RECV_NUM" size="256" type="STRING"/>
					<colinfo id="RECV_NUM" size="256" type="STRING"/>
					<colinfo id="PLAN_ENT_CHG_YN" size="256" type="STRING"/>
					<colinfo id="PLAN_CONFIRM_PER_YN" size="256" type="STRING"/>
					<colinfo id="PLAN_CONT_CHG_YN" size="256" type="STRING"/>
					<colinfo id="ATT_DOC" size="256" type="STRING"/>
					<colinfo id="DEFI_YN" size="4" type="STRING"/>
					<colinfo id="PROC_LIM" size="8" type="STRING"/>
					<colinfo id="PROC_OFFI" size="50" type="STRING"/>
					<colinfo id="PLAN_CONT_CHG_YN_CONT" size="256" type="STRING"/>
					<colinfo id="PLAN_CONFIRM_PER_YN_CONT" size="256" type="STRING"/>
					<colinfo id="PLAN_ENT_CHG_YN_CONT" size="256" type="STRING"/>
					<colinfo id="CHG_INSP" size="256" type="STRING"/>
					<colinfo id="WORK_ITEM_ETC" size="256" type="STRING"/>
					<colinfo id="ETC_INSP_BAS" size="200" type="STRING"/>
					<colinfo id="BEF_PLANER_NAME" size="256" type="STRING"/>
					<colinfo id="PROC_OFFI_ID" size="256" type="STRING"/>
					<colinfo id="ADMIT_DT" size="256" type="STRING"/>
					<colinfo id="USE_ETC" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MASTER">
				<Contents>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_POST_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_DETAIL_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="REP_NM_KOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="COI_WRT_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan">
				<Contents>
					<colinfo id="colname" size="256" summ="default" type="STRING"/>
					<colinfo id="colvaul" size="256" summ="default" type="STRING"/>
					<record>
						<colname>변경</colname>
						<colvaul>변경</colvaul>
					</record>
					<record>
						<colname>해당&#32;없음</colname>
						<colvaul>해당&#32;없음</colvaul>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SUV">
				<Contents>
					<colinfo id="colname" size="256" summ="default" type="STRING"/>
					<colinfo id="colvalue" size="256" summ="default" type="STRING"/>
					<record>
						<colname>해당없음</colname>
						<colvalue>1</colvalue>
					</record>
					<record>
						<colname>감리대상</colname>
						<colvalue>2</colvalue>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_NUMCHK">
				<Contents>
					<colinfo id="KEY_YN" size="20" summ="default" type="STRING"/>
					<colinfo id="DOC_NUM" size="18" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPT_UB_MEMO">
				<Contents>
					<colinfo id="MEMO_DT" size="8" summ="default" type="STRING"/>
					<colinfo id="MEMO_CONT" size="512" summ="default" type="STRING"/>
					<colinfo id="INS_DT" size="24" summ="default" type="STRING"/>
					<colinfo id="UPD_DT" size="24" summ="default" type="STRING"/>
					<colinfo id="WRT_ID" size="16" summ="default" type="STRING"/>
					<colinfo id="RECV_NUM" size="24" summ="default" type="STRING"/>
					<colinfo id="SIGUNGU_CODE" size="24" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="4" summ="default" type="INT"/>
					<colinfo id="CHECKER" size="1" summ="default" type="STRING"/>
					<colinfo id="WRT_TIME" size="4" summ="default" type="STRING"/>
					<colinfo id="WRT_NAME" size="20" summ="default" type="STRING"/>
					<colinfo id="SIDO_CODE" size="24" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPT_R_DEFICIT">
				<Contents>
					<colinfo id="DEFI_SEQ" size="4" summ="default" type="INT"/>
					<colinfo id="RECV_NUM" size="12" summ="default" type="STRING"/>
					<colinfo id="DEFI_CODE" size="6" summ="default" type="STRING"/>
					<colinfo id="DEFI_OUT" size="1" summ="default" type="STRING"/>
					<colinfo id="WRT_ID" size="16" summ="default" type="STRING"/>
					<colinfo id="UPD_DT" size="24" summ="default" type="STRING"/>
					<colinfo id="INS_DT" size="24" summ="default" type="STRING"/>
					<colinfo id="DEFI_CONT" size="512" summ="default" type="STRING"/>
					<colinfo id="SIDO_CODE" size="4" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsPT_R_DEFICIT_CODE">
				<Contents>
					<colinfo id="DEFI_CODE" size="6" summ="default" type="STRING"/>
					<colinfo id="CONT" size="100" summ="default" type="STRING"/>
					<colinfo id="WRT_ID" size="1" summ="default" type="STRING"/>
					<colinfo id="UPD_DT" size="15" summ="default" type="STRING"/>
					<colinfo id="INS_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEFI_GROUP" size="15" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsUSE">
				<Contents>
					<colinfo id="CODE_NAME" size="150" summ="default" type="STRING"/>
					<colinfo id="CODE" size="10" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsWORK">
				<Contents>
					<colinfo id="CODE_NAME" size="150" summ="default" type="STRING"/>
					<colinfo id="CODE" size="10" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Usebefore">
				<Contents>
					<colinfo id="APPLPER_NM" size="50" type="STRING"/>
					<colinfo id="APPLPER_REP" size="20" type="STRING"/>
					<colinfo id="APPLPER_TELNUM" size="26" type="STRING"/>
					<colinfo id="APPLPER_POSTNUM" size="10" type="STRING"/>
					<colinfo id="APPLPER_ADDR" size="60" type="STRING"/>
					<colinfo id="APPLPER_DETAILADDR" size="120" type="STRING"/>
					<colinfo id="OPE_NAME" size="100" type="STRING"/>
					<colinfo id="OPE_TELNUM" size="26" type="STRING"/>
					<colinfo id="OPE_REP" size="20" type="STRING"/>
					<colinfo id="COI_WRT_NUM" size="100" type="STRING"/>
					<colinfo id="OPE_POSTNUM" size="10" type="STRING"/>
					<colinfo id="OPE_ADDR" size="65" type="STRING"/>
					<colinfo id="OPE_DETAILADDR" size="120" type="STRING"/>
					<colinfo id="OFFI_NM" size="50" type="STRING"/>
					<colinfo id="OFFI_TELNUM" size="26" type="STRING"/>
					<colinfo id="SW_DT" size="24" type="STRING"/>
					<colinfo id="INSP_WISH_YMD" size="24" type="STRING"/>
					<colinfo id="EW_DT" size="24" type="STRING"/>
					<colinfo id="PROC_OFFI" size="100" type="STRING"/>
					<colinfo id="INSP_FEE" size="100" type="STRING"/>
					<colinfo id="RECV_DT" size="24" type="STRING"/>
					<colinfo id="PROC_LIM" size="4" type="STRING"/>
					<colinfo id="INSP_SPOT_NM" size="50" type="STRING"/>
					<colinfo id="INSP_SPOT_POSTNUM" size="10" type="STRING"/>
					<colinfo id="INSP_SPOT_ADDR" size="65" type="STRING"/>
					<colinfo id="INSP_SPOT_DETAILADDR" size="120" type="STRING"/>
					<colinfo id="USE" size="200" type="STRING"/>
					<colinfo id="WORK_ITEM" size="200" type="STRING"/>
					<colinfo id="AREA" size="100" type="STRING"/>
					<colinfo id="NUM_FL" size="200" type="STRING"/>
					<colinfo id="ADMIT_DT" size="256" type="STRING"/>
					<colinfo id="WORK_ITEM_ETC" size="256" type="STRING"/>
					<colinfo id="PLAN_CONFIRM_PER_YN_CONT" size="256" type="STRING"/>
					<colinfo id="PLAN_ENT_CHG_YN" size="256" type="STRING"/>
					<colinfo id="PLAN_CONT_CHG_YN_CONT" size="256" type="STRING"/>
					<colinfo id="SW_BEF_REPO_DELINUM" size="256" type="STRING"/>
					<colinfo id="BEF_PLANER_NAME" size="256" type="STRING"/>
					<colinfo id="REMARK" size="256" type="STRING"/>
					<colinfo id="PLAN_ENT_CHG_YN_CONT" size="256" type="STRING"/>
					<colinfo id="DEFI_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsINSP">
				<Contents>
					<colinfo id="USEBEF_INSP" size="4" summ="default" type="STRING"/>
					<colinfo id="WEEKCHK" size="2" summ="default" type="STRING"/>
					<colinfo id="INSTODAY" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_2">
				<Contents>
					<colinfo id="colname" size="256" summ="default" type="STRING"/>
					<colinfo id="colvaul" size="256" summ="default" type="STRING"/>
					<record>
						<colname>확인</colname>
						<colvaul>확인</colvaul>
					</record>
					<record>
						<colname>비확인</colname>
						<colvaul>비확인</colvaul>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="73" Id="Image2" ImageID="form_bottom" Left="8" TabOrder="11" Top="568" Width="816"></Image>
		<Image Height="426" Id="Image1" ImageID="form_bg" Left="8" TabOrder="3" Top="144" Width="817"></Image>
		<Tab BKColor="white" Border="Flat" BorderColor="white" Color="#666666" DisableColor="#c7c7c7" Font="굴림,9,Bold" Height="476" Id="tbMain" Left="24" MouseOverColor="#333333" SelColor="#666666" TabIndex="1" TabOrder="3" Top="158" Width="776">
			<Contents>
				<TabPage BorderColor="black" Height="446" Id="tab5" ImageID="tab_style_100" Left="2" TabOrder="8" Text="기본정보" Top="28" Width="772">
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="110" Id="Static7" Left="6" ShadowColor="#cccccc" TabOrder="35" Text="신청인" Top="20" Type="Groupbox" Width="764"></Static>
					<Static Color="#666666" Font="Tahoma,9" Height="16" Id="Static0" Left="56" TabOrder="37" Text="건축주" Top="38" Width="56"></Static>
					<Image Height="16" Id="Image3" ImageID="arrow_small_white" Left="37" TabOrder="29" Top="36" Width="16"></Image>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="APPLPER_NM" Font="Tahoma,9" Height="21" Id="APPLPER_NM" Left="134" MaxLength="20" Style="style1" TabOrder="1" Top="38" UserData="Y" Width="125"></Edit>
					<Static Color="#666666" Font="Tahoma,9" Height="18" Id="Static2" Left="331" TabOrder="39" Text="대표자" Top="34" Width="49"></Static>
					<Image Height="16" Id="Image4" ImageID="arrow_small_white" Left="313" TabOrder="30" Top="31" Width="16"></Image>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="APPLPER_REP" Font="Tahoma,9" Height="21" Id="APPLPER_REP" Left="416" MaxLength="20" Style="style1" TabOrder="2" Top="32" Width="125"></Edit>
					<Image Height="16" Id="Image16" ImageID="arrow_small_white" Left="37" TabOrder="31" Top="78" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="12" Id="Static16" Left="56" TabOrder="41" Text="주&#32;&#32;소" Top="80" Width="36"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="APPLPER_ADDR" Font="Tahoma,9" Height="21" Id="APPLPER_ADDR" Left="222" MaxLength="64" Style="style1" TabOrder="25" TabStop="FALSE" Top="78" Width="320"></Edit>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="APPLPER_DETAILADDR" Font="Tahoma,9" Height="21" Id="APPLPER_DETAILADDR" Left="134" MaxLength="35" Style="style1" TabOrder="5" Top="102" Width="320"></Edit>
					<Image Height="16" Id="Image8" ImageID="arrow_small_white" Left="313" TabOrder="32" Top="54" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="18" Id="Static3" Left="331" TabOrder="43" Text="연락처" Top="57" Width="57"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="APPLPER_TELNUM" Font="Tahoma,9" Height="21" Id="APPLPER_TELNUM" Left="416" MaxLength="17" Style="style1" TabOrder="3" Top="55" UserData="Y" Width="125"></Edit>
					<Button Height="21" Id="btnPostCode1" ImageID="button_style2_search" Left="190" OnClick="fnEditButton_Click" TabOrder="4" Text="Button0" Top="78" Width="31"></Button>
					<MaskEdit BindDataset="ds_PT_UB_USEBEFORE" Column="APPLPER_POSTNUM" Font="Tahoma,9" Height="21" Id="APPLPER_POSTNUM" Left="134" Mask="###-###" MaxLength="8" TabOrder="24" TabStop="FALSE" Top="78" Type="STRING" Width="55"></MaskEdit>
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="136" Id="NAPPL_YN" Left="6" ShadowColor="#cccccc" TabOrder="44" Text="시공자" Top="144" Type="Groupbox" Width="764"></Static>
					<Image Height="16" Id="Image9" ImageID="arrow_small_white" Left="37" TabOrder="33" Top="158" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="18" Id="Static4" Left="56" TabOrder="46" Text="상&#32;&#32;호&#32;&#32;명" Top="161" Width="57"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="OPE_NAME" Font="Tahoma,9" Height="21" Id="OPE_NAME" Left="134" MaxLength="50" Style="style1" TabOrder="23" TabStop="FALSE" Top="158" UserData="Y" Width="125"></Edit>
					<Image Height="16" Id="Image10" ImageID="arrow_small_white" Left="37" TabOrder="34" Top="181" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="18" Id="Static5" Left="56" TabOrder="48" Text="대표자명" Top="184" Width="57"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="OPE_REP" Font="Tahoma,9" Height="21" Id="OPE_REP" Left="134" MaxLength="20" Style="style1" TabOrder="19" TabStop="FALSE" Top="183" Width="93"></Edit>
					<Image Height="16" Id="Image11" ImageID="arrow_small_white" Left="313" TabOrder="35" Top="184" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="16" Id="Static6" Left="331" TabOrder="50" Text="공사업&#32;번호" Top="187" Width="80"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="COI_WRT_NUM" Font="Tahoma,9" Height="21" Id="COI_WRT_NUM" Left="416" MaxLength="12" Style="style1" TabOrder="21" TabStop="FALSE" Top="183" Width="125"></Edit>
					<Image Height="16" Id="Image12" ImageID="arrow_small_white" Left="37" TabOrder="36" Top="205" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="12" Id="Static8" Left="56" TabOrder="52" Text="주&#32;&#32;소" Top="209" Width="44"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="OPE_ADDR" Font="Tahoma,9" Height="21" Id="OPE_ADDR" Left="193" MaxLength="64" Style="style1" TabOrder="27" TabStop="FALSE" Top="206" Width="214"></Edit>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="OPE_DETAILADDR" Font="Tahoma,9" Height="21" Id="OPE_DETAILADDR" Left="134" Style="style1" TabOrder="28" TabStop="FALSE" Top="229" Width="273"></Edit>
					<Image Height="16" Id="Image13" ImageID="arrow_small_white" Left="313" TabOrder="37" Top="161" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="18" Id="Static9" Left="331" TabOrder="53" Text="연&#32;&#32;&#32;락&#32;&#32;&#32;처" Top="163" Width="73"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="OPE_TELNUM" Font="Tahoma,9" Height="21" Id="OPE_TELNUM" Left="416" MaxLength="17" Style="style1" TabOrder="20" TabStop="FALSE" Top="157" Width="125"></Edit>
					<Image Height="16" Id="Image22" ImageID="arrow_small_white" Left="37" TabOrder="38" Top="250" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static17" Left="56" TabOrder="53" Text="담당자명" Top="253" Width="97"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="OFFI_NM" Font="Tahoma,9" Height="21" Id="OFFI_NM" Left="134" MaxLength="20" Style="style1" TabOrder="7" Top="254" Width="128"></Edit>
					<Image Height="16" Id="Image23" ImageID="arrow_small_white" Left="313" TabOrder="39" Top="251" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static18" Left="331" TabOrder="53" Text="담당자연락처" Top="254" Width="97"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="OFFI_TELNUM" Font="Tahoma,9" Height="21" Id="OFFI_TELNUM" Left="412" MaxLength="17" Style="style1" TabOrder="8" Top="250" Width="144"></Edit>
					<MaskEdit BindDataset="ds_PT_UB_USEBEFORE" Column="OPE_POSTNUM" Font="Tahoma,9" Height="21" Id="OPE_POSTNUM" Left="134" Mask="###-###" MaxLength="8" TabOrder="26" TabStop="FALSE" Top="206" Type="STRING" Width="55"></MaskEdit>
					<Button Height="21" Id="btnOepCode" ImageID="button_style2_search" Left="262" OnClick="fnEditButton_Click" TabOrder="6" Text="Button0" Top="159" Width="31"></Button>
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="112" Id="Static10" Left="6" ShadowColor="#cccccc" TabOrder="52" Text="기타사항" Top="295" Type="Groupbox" Width="764"></Static>
					<Image Height="16" Id="Image19" ImageID="arrow_small_white" Left="308" TabOrder="40" Top="314" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static11" Left="327" TabOrder="54" Text="착&#32;공&#32;일&#32;자" Top="318" Width="97"></Static>
					<Calendar BindDataset="ds_PT_UB_USEBEFORE" Column="SW_DT" Font="Tahoma,9" Height="21" Id="SW_DT" Left="405" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="10" Top="311" Width="104"></Calendar>
					<Image Height="16" Id="Image21" ImageID="arrow_small_white" Left="32" TabOrder="42" Top="336" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static19" Left="51" TabOrder="58" Text="검사희망일" Top="340" Width="97"></Static>
					<Calendar BindDataset="ds_PT_UB_USEBEFORE" Column="INSP_WISH_YMD" Font="Tahoma,9" Height="21" Id="INSP_WISH_YMD" Left="129" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="11" Top="336" Width="104"></Calendar>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static12" Left="326" TabOrder="56" Text="준&#32;공&#32;일&#32;자" Top="341" Width="73"></Static>
					<Image Height="16" Id="Image20" ImageID="arrow_small_white" Left="308" TabOrder="41" Top="338" Width="16"></Image>
					<Calendar BindDataset="ds_PT_UB_USEBEFORE" Column="EW_DT" Font="Tahoma,9" Height="21" Id="EW_DT" Left="405" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="12" Top="335" Width="104"></Calendar>
					<Image Height="16" Id="Image2" ImageID="arrow_small_white" Left="308" TabOrder="43" Top="359" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="16" Id="Static14" Left="327" TabOrder="60" Text="검사수수료" Top="362" Width="72"></Static>
					<Image Height="16" Id="Image0" ImageID="arrow_small_white" Left="32" TabOrder="44" Top="379" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static15" Left="51" TabOrder="62" Text="접&#32;수&#32;일&#32;자" Top="383" Width="97"></Static>
					<MaskEdit BindDataset="ds_PT_UB_USEBEFORE" Column="INSP_FEE" Font="Tahoma,9" Height="21" Id="INSP_FEE" Left="405" Mask="###,###,###,###" MaxLength="8" TabOrder="14" Top="358" TrimType="Right" VAlign="BOTTOM" Width="105"></MaskEdit>
					<Calendar BindDataset="ds_PT_UB_USEBEFORE" Column="RECV_DT" Font="Tahoma,9" Height="21" Id="RECV_DT" Left="129" OnChanged="tbMain_tab5_RECV_DT_OnChanged" OnKillFocus="fnKillFocus" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="17" Top="379" Width="104"></Calendar>
					<Image Height="16" Id="Image1" ImageID="arrow_small_white" Left="308" TabOrder="45" Top="379" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static1" Left="327" TabOrder="64" Text="처&#32;리&#32;기&#32;한" Top="383" Width="97"></Static>
					<Calendar BindDataset="ds_PT_UB_USEBEFORE" Column="PROC_LIM" Font="Tahoma,9" Height="21" Id="PROC_LIM" Left="405" OnKillFocus="fnKillFocus" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="18" Top="380" Width="104"></Calendar>
					<Image Height="16" Id="Image5" ImageID="arrow_small_white" Left="32" TabOrder="46" Top="315" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static20" Left="51" TabOrder="65" Text="처리담당자" Top="318" Width="73"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="PROC_OFFI" Font="Tahoma,9" Height="21" Id="PROC_OFFI" Left="129" MaxLength="10" Style="style1" TabOrder="22" TabStop="FALSE" Top="310" Width="101"></Edit>
					<Button Height="21" Id="btnProcSch" ImageID="button_style2_search" Left="234" OnClick="fnEditButton_Click" TabOrder="9" Text="Button0" Top="313" Width="31"></Button>
					<Image Height="16" Id="Image6" ImageID="arrow_small_white" Left="524" TabOrder="47" Top="359" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="16" Id="Static13" Left="543" TabOrder="68" Text="재&#32;&#32;&#32;검&#32;&#32;&#32;사" Top="361" Width="64"></Static>
					<Checkbox BindDataset="ds_PT_UB_USEBEFORE" Column="CHG_INSP" FalseValue="0" Height="18" Id="CHG_INSP" Left="622" OnClick="CHG_INSP_OnClick" TabOrder="15" Top="359" TrueValue="1" Value="FALSE" Width="15"></Checkbox>
					<Button Height="21" Id="btnReSch" ImageID="button_style2_search" Left="645" OnClick="fnEditButton_Click" TabOrder="16" Text="Button0" Top="358" Width="31"></Button>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="PROC_OFFI_ID" Font="Tahoma,9" Height="21" Id="PROC_OFFI_ID" Left="529" MaxLength="10" Style="style1" TabOrder="48" TabStop="FALSE" Top="313" Visible="FALSE" Width="101"></Edit>
					<Checkbox FalseValue="0" Height="18" Id="chk_hid" Left="614" OnClick="Chk_Hid_OnClick" TabOrder="49" Top="157" TrueValue="1" Value="FALSE" Width="15"></Checkbox>
					<Static Color="#666666" Font="Tahoma,9" Height="16" Id="Static21" Left="574" TabOrder="72" Text="수작업" Top="158" Width="40"></Static>
					<Image Height="16" Id="Image7" ImageID="arrow_small_white" Left="556" TabOrder="50" Top="159" Width="16"></Image>
					<Image Height="16" Id="Image14" ImageID="arrow_small_white" Left="32" TabOrder="51" Top="359" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static22" Left="51" TabOrder="75" Text="면&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;적" Top="360" Width="87"></Static>
					<MaskEdit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="AREA" Font="Tahoma,9" Height="21" Id="AREA" Left="129" MaxLength="9" OnKeyDown="tbMain_tab5_AREA_OnKeyDown" TabOrder="13" Top="357" TrimType="Right" VAlign="BOTTOM" Width="58"></MaskEdit>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static23" Left="189" TabOrder="76" Text="㎡" Top="361" Width="23"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="446" Id="tab1" ImageID="tab_style_100" Left="2" TabOrder="25" Text="건축정보" Top="28" Width="772">
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="113" Id="Static4" Left="6" ShadowColor="#cccccc" TabOrder="28" Text="건축물정보" Top="101" Type="Groupbox" Width="764"></Static>
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="63" Id="Static15" Left="8" ShadowColor="#cccccc" TabOrder="47" Text="비고" Top="375" Type="Groupbox" Width="764"></Static>
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="72" Id="Static10" Left="6" ShadowColor="#cccccc" TabOrder="23" Text="시공현장정보" Top="17" Type="Groupbox" Width="764"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="INSP_SPOT_DETAILADDR" Font="Tahoma,9" Height="21" Id="INSP_SPOT_DETAILADDR" Left="462" MaxLength="30" Style="style1" TabOrder="3" Top="61" UserData="Y" Width="168"></Edit>
					<Image Height="16" Id="Image8" ImageID="arrow_small_white" Left="14" TabOrder="24" Top="36" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static11" Left="32" TabOrder="25" Text="검사현장명칭" Top="38" Width="97"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="INSP_SPOT_NM" Font="Tahoma,9" Height="21" Id="INSP_SPOT_NM" Left="110" MaxLength="45" Style="style1" TabOrder="1" Top="34" Width="344"></Edit>
					<Image Height="16" Id="Image17" ImageID="arrow_small_white" Left="14" TabOrder="26" Top="62" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="12" Id="Static12" Left="32" TabOrder="27" Text="주&#32;&#32;소" Top="64" Width="92"></Static>
					<MaskEdit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="INSP_SPOT_POSTNUM" Font="Tahoma,9" Height="21" Id="INSP_SPOT_POSTNUM" Left="110" Mask="###-###" MaxLength="8" TabOrder="21" TabStop="FALSE" Top="61" Type="STRING" UserData="Y" Width="55"></MaskEdit>
					<Button Height="21" Id="btnPostCode3" ImageID="button_style2_search" Left="174" OnClick="fnEditButton_Click" TabOrder="2" Text="Button0" Top="62" Width="31"></Button>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="INSP_SPOT_ADDR" Font="Tahoma,9" Height="21" Id="INSP_SPOT_ADDR" Left="202" MaxLength="30" Style="style1" TabOrder="22" TabStop="FALSE" Top="61" UserData="Y" Width="252"></Edit>
					<Image Height="16" Id="Image9" ImageID="arrow_small_white" Left="15" TabOrder="29" Top="126" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="14" Id="Static16" Left="33" TabOrder="30" Text="건축물용도" Top="127" Width="88"></Static>
					<Image Height="16" Id="Image10" ImageID="arrow_small_white" Left="14" TabOrder="31" Top="151" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static17" Left="33" TabOrder="32" Text="검사대상공사" Top="153" Width="87"></Static>
					<Image Height="16" Id="Image0" ImageID="arrow_small_white" Left="595" TabOrder="33" Top="153" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static1" Left="612" TabOrder="34" Text="면&#32;&#32;&#32;&#32;&#32;&#32;&#32;적" Top="154" Width="87"></Static>
					<Image Height="16" Id="Image1" ImageID="arrow_small_white" Left="396" TabOrder="35" Top="153" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="16" Id="Static2" Left="412" TabOrder="36" Text="층&#32;&#32;&#32;&#32;&#32;&#32;&#32;수" Top="155" Width="72"></Static>
					<MaskEdit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="AREA" Font="Tahoma,9" Height="21" Id="AREA" Left="679" MaxLength="9" TabOrder="15" Top="151" TrimType="Right" VAlign="BOTTOM" Width="58"></MaskEdit>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="NUM_FL" Font="Tahoma,9" Height="21" Id="NUM_FL" Left="479" MaxLength="55" Style="style1" TabOrder="14" Top="152" Width="95"></Edit>
					<Checkbox Font="Tahoma,9" Height="13" Id="WRK001" Left="109" OnClick="fn_Work_itme" TabOrder="5" Text="구내통신선로설비" Top="154" UserData="WRK001" Value="FALSE" Width="175"></Checkbox>
					<Checkbox Font="Tahoma,9" Height="21" Id="WRK002" Left="109" OnClick="fn_Work_itme_etc" TabOrder="7" Text="방송공동수신설비" Top="185" UserData="WRK002" Value="FALSE" Width="123"></Checkbox>
					<Checkbox Font="Tahoma,9" Height="21" Id="WRK003" Left="109" OnClick="fn_Work_itme" TabOrder="6" Text="이동통신구내선로설비" Top="167" UserData="WRK003" Value="FALSE" Width="183"></Checkbox>
					<Combo BindDataset="ds_PT_UB_USEBEFORE" CodeColumn="CODE" Column="USE" DataColumn="CODE_NAME" Font="Tahoma,9" Height="21" Id="USE" InnerDataset="dsUSE" Left="108" TabOrder="4" Top="124" UserData="Y" Width="160"></Combo>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static5" Left="742" TabOrder="37" Text="㎡" Top="158" Width="23"></Static>
					<Checkbox Font="Tahoma,9" Height="21" Id="Checkbox0" Left="244" OnClick="fn_Work_itme_etc" TabOrder="8" Text="지상파&#32;TV" Top="186" UserData="WRK002" Value="FALSE" Width="84"></Checkbox>
					<Checkbox Font="Tahoma,9" Height="21" Id="Checkbox1" Left="325" OnClick="fn_Work_itme_etc" TabOrder="9" Text="위성방송" Top="187" UserData="WRK002" Value="FALSE" Width="76"></Checkbox>
					<Checkbox Font="Tahoma,9" Height="21" Id="Checkbox2" Left="399" OnClick="fn_Work_itme_etc" TabOrder="10" Text="FM라디오방송" Top="187" UserData="WRK002" Value="FALSE" Width="100"></Checkbox>
					<Checkbox Font="Tahoma,9" Height="21" Id="Checkbox3" Left="500" OnClick="fn_Work_itme_etc" TabOrder="11" Text="종합유선방송" Top="187" UserData="WRK002" Value="FALSE" Width="92"></Checkbox>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static7" Left="596" TabOrder="38" Text=")" Top="190" Width="15"></Static>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static8" Left="236" TabOrder="39" Text="(" Top="188" Width="15"></Static>
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="133" Id="Static9" Left="6" ShadowColor="#cccccc" TabOrder="40" Text="착공전&#32;설계도&#32;관련정보" Top="230" Type="Groupbox" Width="764"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="BEF_PLANER_NAME" Font="Tahoma,9" Height="20" Id="BEF_PLANER_NAME" Left="182" MaxLength="25" Style="style1" TabOrder="41" TabStop="FALSE" Top="339" Width="179"></Edit>
					<Static Color="#666666" Font="Tahoma,9" Height="20" Id="Static13" Left="40" TabOrder="42" Text="설계&#32;업체명" Top="341" Width="144"></Static>
					<Image Font="Tahoma,9" Height="16" Id="Image3" ImageID="arrow_small_white" Left="22" TabOrder="43" Top="340" Width="16"></Image>
					<Button Height="21" Id="btnBeForCode" ImageID="button_style2_search" Left="368" OnClick="fnEditButton_Click" TabOrder="19" Text="Button0" Top="321" Width="31"></Button>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="SW_BEF_REPO_DELINUM" Font="Tahoma,9" Height="20" Id="SW_BEF_REPO_DELINUM" Left="182" MaxLength="25" Style="style1" TabOrder="44" TabStop="FALSE" Top="319" Width="178"></Edit>
					<Static Color="#666666" Font="Tahoma,9" Height="20" Id="Static14" Left="40" TabOrder="45" Text="착공전설계도&#32;교부번호" Top="320" Width="144"></Static>
					<Image Font="Tahoma,9" Height="16" Id="Image5" ImageID="arrow_small_white" Left="22" TabOrder="46" Top="319" Width="16"></Image>
					<TextArea BindDataset="ds_PT_UB_USEBEFORE" Column="REMARK" Font="Tahoma,9" Height="39" Id="REMARK" Left="21" MaxLength="150" TabOrder="20" Top="392" Width="737"></TextArea>
					<Radio BindDataset="ds_PT_UB_USEBEFORE" Border="None" BorderColor="white" CodeColumn="colvaul" Column="PLAN_CONT_CHG_YN" ColumnCount="3" DataColumn="colname" Font="Tahoma,9" Height="21" Id="Radio2" INDEX="0" InnerDataset="ds_plan" Left="168" OnClick="fn_Radio_OnClick" TabOrder="18" Top="294" Width="144"></Radio>
					<Radio BindDataset="ds_PT_UB_USEBEFORE" Border="None" BorderColor="white" CodeColumn="colvaul" Column="PLAN_ENT_CHG_YN" ColumnCount="3" DataColumn="colname" Font="Tahoma,9" Height="21" Id="Radio1" INDEX="0" InnerDataset="ds_plan" Left="168" OnClick="fn_Radio_OnClick" TabOrder="17" Top="273" Width="144"></Radio>
					<Radio BindDataset="ds_PT_UB_USEBEFORE" Border="None" BorderColor="white" CodeColumn="colvaul" Column="PLAN_CONFIRM_PER_YN" ColumnCount="3" DataColumn="colname" Font="Tahoma,9" Height="21" Id="Radio0" INDEX="0" InnerDataset="ds_plan_2" Left="168" OnClick="fn_Radio_OnClick" TabOrder="16" Top="253" Width="128"></Radio>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="PLAN_CONT_CHG_YN_CONT" Font="Tahoma,9" Height="20" Id="PLAN_CONT_CHG_YN_CONT" Left="318" MaxLength="25" Style="style1" TabOrder="48" TabStop="FALSE" Top="294" Width="408"></Edit>
					<Static Color="#666666" Font="Tahoma,9" Height="20" Id="Static18" Left="41" TabOrder="49" Text="설계&#32;내용&#32;변경&#32;여부" Top="298" Width="128"></Static>
					<Image Font="Tahoma,9" Height="16" Id="Image6" ImageID="arrow_small_white" Left="23" TabOrder="50" Top="295" Width="16"></Image>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="PLAN_ENT_CHG_YN_CONT" Font="Tahoma,9" Height="20" Id="PLAN_ENT_CHG_YN_CONT" Left="318" MaxLength="60" Style="style1" TabOrder="51" TabStop="FALSE" Top="272" Width="408"></Edit>
					<Static Color="#666666" Font="Tahoma,9" Height="20" Id="Static19" Left="41" TabOrder="52" Text="설계&#32;업체&#32;변경&#32;여부" Top="276" Width="128"></Static>
					<Image Font="Tahoma,9" Height="16" Id="Image7" ImageID="arrow_small_white" Left="23" TabOrder="53" Top="274" Width="16"></Image>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="PLAN_CONFIRM_PER_YN_CONT" Font="Tahoma,9" Height="20" Id="PLAN_CONFIRM_PER_YN_CONT" Left="318" MaxLength="25" Readonly="TRUE" Style="style1" TabOrder="54" TabStop="FALSE" Top="250" Width="408"></Edit>
					<Static Color="#666666" Font="Tahoma,9" Height="24" Id="Static20" Left="42" TabOrder="55" Text="설계&#32;확인&#32;수행여부" Top="254" Width="127"></Static>
					<Image Font="Tahoma,9" Height="16" Id="Image11" ImageID="arrow_small_white" Left="23" TabOrder="56" Top="254" Width="16"></Image>
					<Checkbox Font="Tahoma,9" Height="22" Id="OPE_Addr_Get" Left="646" OnClick="fnOPE_Addr_Get_Click" TabOrder="57" Text="건축주&#32;주소&#32;입력" Top="57" Value="FALSE" Width="120"></Checkbox>
					<Checkbox Font="Tahoma,9" Height="13" Id="WRK004" Left="581" OnClick="fn_Work_itme" TabOrder="12" Text="텔레비전공동시청안테나설비" Top="180" UserData="WRK004" Value="FALSE" Visible="FALSE" Width="187"></Checkbox>
					<Image Height="16" Id="Image2" ImageID="arrow_small_white" Left="396" TabOrder="58" Top="125" Width="16"></Image>
					<Static Color="#666666" Font="Tahoma,9" Height="16" Id="Static0" Left="412" TabOrder="59" Text="건축허가일" Top="126" Width="72"></Static>
					<Calendar BindDataset="ds_PT_UB_USEBEFORE" Column="ADMIT_DT" Font="Tahoma,9" Height="21" Id="ADMIT_DT" Left="479" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="13" Top="123" Width="104"></Calendar>
					<Static Color="#666666" Font="Tahoma,9" Height="13" Id="Static21" Left="576" TabOrder="60" Text="층" Top="156" Width="23"></Static>
					<Edit BindDataset="ds_PT_UB_USEBEFORE" Column="USE_ETC" Font="Tahoma,9" Height="21" Id="USE_ETC" Left="269" MaxLength="22" OnKillFocus="tbMain_tab1_USE_ETC_OnKillFocus" Style="style1" TabOrder="61" Top="124" Width="120"></Edit>
				</TabPage>
				<TabPage BorderColor="black" Height="446" Id="tab6" ImageID="tab_style_100" Left="2" TabOrder="8" Text="흠결검토" Top="28" Width="772">
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="214" Id="Static0" Left="6" ShadowColor="#cccccc" TabOrder="1" Text="흠결검토" Top="19" Type="Groupbox" Width="764"></Static>
					<Grid BindDataset="dsPT_R_DEFICIT" BkColor2="#f0f0f0" BkSelColor="#7498b7" BoldHead="true" Border="HalfFlat" BorderColor="#bbc3cc" Bottom="206" ButtonColor="user0" Color="#666666" Editable="TRUE" Enable="true" EndLineColor="#999999" Face3dColor="#999999" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grdPaper" InputPanel="FALSE" Left="22" LineColor="user9" OnHeadClick="fnLocalGridHead_Click" Right="756" SelColor="white" ShadowColor="#999999" Style="grid_title" TabOrder="2" TabStop="true" Top="38" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="734">
						<contents>
							<format id="Default">
								<columns>
									<col width="688"/>
									<col width="42"/>
								</columns>
								<head>
									<cell bkcolor="#787878" col="0" color="white" display="text" text="흠&#32;결&#32;검&#32;토&#32;내&#32;용"/>
									<cell bkcolor="#787878" col="1" color="white" display="checkbox" edit="checkbox" text="확인"/>
								</head>
								<body>
									<cell col="0" colid="DEFI_CONT" display="text"/>
									<cell col="1" colid="DEFI_OUT" display="checkbox" edit="checkbox"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Image Height="70" Id="Image1" ImageID="bg_tip764" Left="6" TabOrder="3" Top="372" Width="764"></Image>
					<Image Height="11" Id="Image5" ImageID="arrow_small_blue2" Left="30" TabOrder="4" Top="398" Width="11"></Image>
				</TabPage>
				<TabPage BorderColor="black" Height="446" Id="tpMemo" ImageID="tab_style_100" Left="2" TabOrder="8" Text="메모" Top="28" Width="772">
					<Static Color="#ff6600" Font="굴림,9,Bold" Height="333" Id="Static1" Left="6" ShadowColor="#cccccc" TabOrder="2" Text="메&#32;&#32;모" Top="20" Type="Groupbox" Width="764"></Static>
					<Grid BindDataset="dsPT_UB_MEMO" BkColor2="#f0f0f0" BkSelColor="#7498b7" BoldHead="true" Border="HalfFlat" BorderColor="#bbc3cc" Bottom="187" ButtonColor="user0" Color="#666666" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="#666666" Face3dColor="#666666" HeadBorder="Flat" HeadHeight="20" Height="147" Id="grdMemo" InputPanel="FALSE" Left="21" LineColor="user9" OnHeadClick="fnGridHead_Click" Right="755" SelColor="white" ShadowColor="#999999" Style="grid_title" TabOrder="1" TabStop="true" Top="40" UseAutoSizing="Row" UseDBuff="true" UseExSizing="Row" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="734">
						<contents>
							<format id="Default">
								<columns>
									<col width="37"/>
									<col width="521"/>
									<col width="79"/>
									<col width="80"/>
								</columns>
								<head>
									<cell bkcolor="#787878" col="0" color="white" display="checkbox" edit="checkbox" text="선택"/>
									<cell bkcolor="#787878" col="1" color="white" display="text" text="메&#32;모&#32;내&#32;용"/>
									<cell bkcolor="#787878" col="2" color="white" display="text" text="작성자"/>
									<cell bkcolor="#787878" col="3" color="user2" display="text" text="작성일자"/>
								</head>
								<body>
									<cell col="0" colid="CHECKER" display="checkbox" edit="checkbox"/>
									<cell col="1" colid="MEMO_CONT" display="text"/>
									<cell col="2" colid="WRT_NAME" display="text"/>
									<cell col="3" colid="MEMO_DT" display="date" edit="date"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Font="Tahoma,9" Height="15" Id="Static2" Left="43" TabOrder="5" Text="작성일자" Top="201" Width="55"></Static>
					<Calendar BindDataset="dsPT_UB_MEMO" Column="MEMO_DT" Height="21" Id="MEMO_DT" Left="100" SaturdayTextColor="blue" SundayTextColor="red" TabOrder="2" Top="197" Value="TODAY" Width="101"></Calendar>
					<TextArea BindDataset="dsPT_UB_MEMO" CheckLength="Byte" Column="MEMO_CONT" Height="75" Id="MEMO_CONTENT" Left="23" MaxLength="512" TabOrder="5" Top="224" Width="734"></TextArea>
					<Image Height="16" Id="Image4" ImageID="arrow_small_white" Left="26" TabOrder="5" Top="197" Width="16"></Image>
					<Edit BindDataset="dsPT_UB_MEMO" Column="WRT_NAME" Height="21" Id="WRT_NAME" Left="328" TabOrder="4" Top="197" Width="89"></Edit>
					<Static Font="Tahoma,9" Height="15" Id="Static0" Left="273" TabOrder="6" Text="작&#32;성&#32;자" Top="201" Width="55"></Static>
					<Image Height="16" Id="Image8" ImageID="arrow_small_white" Left="256" TabOrder="7" Top="197" Width="16"></Image>
					<MaskEdit BindDataset="dsPT_UB_MEMO" Column="WRT_TIME" Height="21" Id="WRT_TIME" Left="201" Mask="##:##" MaxLength="4" TabOrder="3" Top="197" Type="STRING" Width="41"></MaskEdit>
					<Image Height="32" Id="Image0" ImageID="button_bg" Left="424" TabOrder="8" Top="311" Width="330"></Image>
					<Button ButtonStyle="TRUE" Color="#133f7e" DisableColor="#c7c7c7" Font="굴림,9,Bold" Height="21" Id="btnMemoInsert" ImageID="button_style2_100" Left="435" OnClick="fnMemoButton_Click" Style="button_style01" TabOrder="8" Text="입력" Top="317" Width="56"></Button>
					<Button ButtonStyle="TRUE" Color="#133f7e" DisableColor="#c7c7c7" Font="굴림,9,Bold" Height="21" Id="btnMemoModify" ImageID="button_style2_100" Left="497" OnClick="fnMemoButton_Click" Style="button_style01" TabOrder="10" Text="수정" Top="317" Width="56"></Button>
					<Button ButtonStyle="TRUE" Color="#133f7e" DisableColor="#c7c7c7" Font="굴림,9,Bold" Height="21" Id="btnMemoRemove" ImageID="button_style2_100" Left="683" OnClick="fnMemoButton_Click" Style="button_style01" TabOrder="16" Text="삭제" Top="317" Width="56"></Button>
					<Button ButtonStyle="TRUE" Color="#133f7e" DisableColor="#c7c7c7" Font="굴림,9,Bold" Height="21" Id="btnMemoSave" ImageID="button_style2_100" Left="559" OnClick="fnMemoButton_Click" Style="button_style01" TabOrder="12" Text="저장" Top="317" Width="56"></Button>
					<Button ButtonStyle="TRUE" Color="#133f7e" DisableColor="#c7c7c7" Font="굴림,9,Bold" Height="21" Id="btnMemoCancel" ImageID="button_style2_100" Left="621" OnClick="fnMemoButton_Click" Style="button_style01" TabOrder="14" Text="취소" Top="317" Width="56"></Button>
					<Image Height="70" Id="Image1" ImageID="bg_tip764" Left="6" TabOrder="17" Top="372" Width="764"></Image>
					<Image Height="11" Id="Image3" ImageID="arrow_small_blue2" Left="30" TabOrder="18" Top="397" Width="11"></Image>
				</TabPage>
			</Contents>
		</Tab>
		<Div BKColor="#c6dce1" Height="54" Id="divButtonBar" Left="8" TabOrder="1" Text="Div0" Top="12" Url="base::frmButtonBar.xml" Width="820">
			<Contents></Contents>
		</Div>
		<Image Height="72" Id="Image0" ImageID="form_top" Left="8" TabOrder="2" Top="78" Width="816"></Image>
		<Image Height="56" Id="Image6" ImageID="bg_default" Left="24" TabOrder="4" Top="94" Width="784"></Image>
		<Button ButtonStyle="TRUE" Color="#333333" Font="굴림,9,Bold" Height="21" Id="btnCheck" ImageID="button_style2_120" Left="296" OnClick="fnDCheck_Click" Style="button_style01" TabOrder="6" Text="중복체크" Top="116" Width="66"></Button>
		<Edit BindDataset="ds_PT_UB_USEBEFORE" BKColor="#fdefe4" Column="CIV_RECV_NUM" Height="19" Id="CIV_RECV_NUM" Left="120" MaxLength="20" TabOrder="7" Top="117" UserData="Y" Width="176"></Edit>
		<Static Color="#666666" Height="18" Id="Static20" Left="63" TabOrder="8" Text="접수번호" Top="117" Width="57"></Static>
		<Image Height="11" Id="Image3" ImageID="arrow_small_blue" Left="45" TabOrder="9" Top="118" Width="11"></Image>
		<Image Height="26" Id="Image5" ImageID="tab_style_bg" Left="464" TabOrder="10" Top="158" Width="334"></Image>
		<Button ButtonStyle="TRUE" Color="#333333" Font="굴림,9,Bold" Height="21" Id="btnNapplSch" ImageID="button_style2_120" Left="728" OnClick="fnEditButton_Click" Style="button_style01" TabOrder="12" Text="부적합검색" Top="112" Width="66"></Button>
	</Form>
	<Script><![CDATA[
/*
1. 파일명 : UBReceiptMgrC.xml
2. 작성일 : 2009-02-06
3. 작성자 : 이 종 영
4. 기  능 : 사용전 검사 접수
5. 변경이력
  가. 2009-02-06 최초작성 (이종영)
  나. 2011-04-26 수정 (이석곤)
*/

#include "UserLib::CommonJs.js"

//////////////////////////////////////////////////////////////////
// 전역변수
//////////////////////////////////////////////////////////////////
var	_bDialog = false;
var _sWorkFlag;
var scRECV_NUM;  
var vales;
var etc;
var scSearch = false;
var base_code = "WRT_ID="+global.g_User_ID+" SIDO_CODE="+global.g_Sd_cd+" SIGUNGU_CODE="+global.g_Sgg_cd;
//////////////////////////////////////////////////////////////////
// Form Load 이벤트
//////////////////////////////////////////////////////////////////
function fnForm_Loaded(obj)
{

	if(_bDialog)
	{
		this.divButtonBar.Visible = false;
	}
	
	global.gv_WorkFlag = global.gv_INQUIRY;
	global.gv_WorkFlag = _sWorkFlag;
	//this.tbMain.tab5.PROC_LIM.Value = AddDate(Today(), +14);
	
	
	fnControlState(false, this.tbMain.tab1, "SW_BEF_REPO_DELINUM");
	
	if(global.gv_WorkFlag == global.gv_INQUIRY)
	{
		fnInquiry();
	}
	else if(global.gv_WorkFlag == global.gv_INSERT)
	{	
		fnInsert();
	}
	else if(global.gv_WorkFlag == global.gv_MODIFY)
	{	
		fnModify();
	}
	
	divButtonBar.Image1.text = space(6) + "사용전검사 접수관리";
	
	tbMain.TabIndex = 0;
	
	//tbMain.tab5.INSP_FEE.Enable = false;
}

function fnForm_Activate(obj)
{
	global.g_activeFrm = this.Id;
}

//////////////////////////////////////////////////////////////////
// 공통기능
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnInitButtonBar
 2. 기  능 : 화면상단 버튼상태 설정
 3. Params 
    없음
 4. Return
    없음
*/
function fnInitButtonBar()
{
	if (global.gv_WorkFlag == global.gv_INQUIRY)
	{
		fnAllControlState(false, this);
		
		divButtonBar.btnInsert.enable = false;
		divButtonBar.btnModify.enable = true;
		divButtonBar.btnRemove.enable = false;
		
		divButtonBar.btnSave.enable = fnSetMenuSaveButtonAuth(3, false);
		divButtonBar.btnReport.enable = false;
		divButtonBar.btnExcel.enable = false;
		
		
	}
	else if (global.gv_WorkFlag == global.gv_INSERT)
	{
		fnAllControlState(true, this);
		
		divButtonBar.btnInsert.enable = false;
		divButtonBar.btnModify.enable = false;
		divButtonBar.btnRemove.enable = false;
		
		divButtonBar.btnSave.enable = fnSetMenuSaveButtonAuth(2, true);
		divButtonBar.btnReport.enable = false;
		divButtonBar.btnExcel.enable = false;
	}
	else
	{
		fnAllControlState(true, this);
		
		divButtonBar.btnInsert.enable = false;
		divButtonBar.btnModify.enable = false;	
		divButtonBar.btnRemove.enable = false;
		
		divButtonBar.btnSave.enable = fnSetMenuSaveButtonAuth(2, true);
		divButtonBar.btnReport.enable = false;
		divButtonBar.btnExcel.enable = false;		
	}
}

/**
 1. 함수명 : fnTablesBinding
 2. 기  능 : 검색조건에 대한 검색
 3. Params 
    없음
 4. Return
    없음
*/
function fnTablesBinding()
{
	
}

function fn_CallBack(Svcid, sErrCode, sErrMsg) 
{
	if (sErrCode < 0) 	
	{
		alert(sErrCode + " : " + sErrMsg);
		if (svcid == "SEARCH")
		{
			alert('데이터 조회 중 오류가 발생하였습니다.');
		}
		if (svcid == "DELETE")
		{
			alert('데이터 삭제 중 오류가 발생하였습니다.');
		}
		if (svcid == "save")
		{
			alert('데이터 저장 중 오류가 발생하였습니다.');
		}
		if (svcid == "MEMO_SAVE")
		{
			alert('메모 저장 중 오류가 발생하였습니다.');
		}
		return;
	}
	
	if (svcid == "DELETE")
	{
		alert('삭제되었습니다.');
		return;
	}
	
	if (svcid == "MEMO_DELETE")
	{
		alert('메모가 삭제 되었습니다.');
		return;
	}
	
	if (svcid == "save")
	{
		alert('저장되었습니다.');
		global.gv_WorkFlag = global.gv_INQUIRY;
		fnInitButtonBar();
		return;
	}
	
	if (svcid == "MEMO_SAVE")
	{
		alert('메모가 저장되었습니다.');
		fnMemoButton_Click(tbMain.tpMemo.btnMemoCancel);
		fnInitMemoGroup("INQUIRY");
		return;
	}
	
	if (svcid == "MASTER_CODE")
	{
		fnControlState(false, this.tbMain.tab5, "OPE_NAME,OPE_POSTNUM,OPE_ADDR,OPE_DETAILADDR,OPE_REP,OPE_TELNUM,COI_WRT_NUM");
		fnControlState(false, this.tbMain.tab1, "SW_BEF_REPO_DELINUM");
		this.tbMain.tab5.OPE_NAME.Text = ds_MASTER.GetColumn(0,"NAME");
		ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row,"OPE_POSTNUM",ds_MASTER.GetColumn(0,"ADDR_POST_NUM").replace("-",""));
		//this.tbMain.tab5.OPE_POSTNUM.Text = ds_MASTER.GetColumn(0,"ADDR_POST_NUM").replace("-","");
		this.tbMain.tab5.OPE_ADDR.Text = ds_MASTER.GetColumn(0,"ADDR_ADDR");
		this.tbMain.tab5.OPE_DETAILADDR.Text = ds_MASTER.GetColumn(0,"ADDR_DETAIL_ADDR");
		this.tbMain.tab5.OPE_REP.Text = ds_MASTER.GetColumn(0,"REP_NM_KOR");
		this.tbMain.tab5.OPE_TELNUM.Text = ds_MASTER.GetColumn(0,"ADDR_TEL_NUM");
		this.tbMain.tab5.COI_WRT_NUM.Text = ds_MASTER.GetColumn(0,"COI_WRT_NUM");
		
		return;
	}
	
	if(svcid == "NUM_CODE"){
	
		var chk = ds_NUMCHK.GetColumn(0, "KEY_YN");
	
		var DOC_NUM = ds_NUMCHK.GetColumn(0, "DOC_NUM");
	
	
		if(chk != "Y"){
			alert('이미 등록된 접수 번호 입니다.');
			this.CIV_RECV_NUM.Text = "";
			this.CIV_RECV_NUM.SetFocus();
			return;
		}else{
	
			ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row, "RECV_NUM", DOC_NUM);
			scRECV_NUM = DOC_NUM;
						
			fnToInsert();	
			
					
		}
		
	}
	
	if(svcid == "GET_CODE"){

        //seokgon 2011-04-07 수정 		 
	    var USEBEF_INSP = dsINSP.GetColumn(0,"USEBEF_INSP");
        var WEEKCHK = dsINSP.GetColumn(0,"WEEKCHK");
        var INSTODAY = dsINSP.GetColumn(0,"INSTODAY");
    if(tbMain.tab5.PROC_LIM.Value ==null){
    	if(USEBEF_INSP==null)
    	{
    	
      	tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,14,0,"add");	
    	}    	
    	else if(global.g_Sgg_cd=="cbji") {
    	tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,USEBEF_INSP,WEEKCHK,INSTODAY);	
  		}
    	else{    	    	
    	tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,USEBEF_INSP,WEEKCHK,INSTODAY);	
    	
       	//tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,USEBEF_INSP,WEEKCHK,INSTODAY);	
  		}
	    }
		fnInitButtonBar();
		fnControlState(false, this, "CIV_RECV_NUM,btnCheck");	
		fnControlState(false, this.tbMain.tab5, "OPE_NAME,OPE_POSTNUM,OPE_ADDR,OPE_DETAILADDR,OPE_REP,OPE_TELNUM,COI_WRT_NUM");
		fnControlState(false, this.tbMain.tab1, "SW_BEF_REPO_DELINUM");
		fnControlState(false, this.tbMain.tab5, "PROC_OFFI");
		fnInitMemoGroup("INQUIRY");
		
		this.tbMain.tab1.WRK001.Enable = true;
		this.tbMain.tab1.WRK002.Enable = true;
		this.tbMain.tab1.WRK003.Enable = true;
		this.tbMain.tab1.WRK004.Enable = true;
		
		
		vales = ds_PT_UB_USEBEFORE.GetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM");
		var strwork = SubStr(vales,0,IndexOf(vales,"/"));
		var strlist = Split2(vales+"/","/","/");
		
		//2009-11-12 앞 4자리까지만 추출해서 비교해서 처리 풀로비교시에 비정상처리되는 경우가 많음
		for(i = 0; i < Length(strlist); i++){
			var strlist2 = strlist[i].replace("[","").replace("]","");
			if(substr(this.tbMain.tab1.WRK001.Text,0,4) == substr(strlist2,0,4))
			{
				this.tbMain.tab1.WRK001.Value = 1;
			}
			else if(substr(this.tbMain.tab1.WRK003.Text,0,4) == substr(strlist2,0,4))
			{
				this.tbMain.tab1.WRK003.Value = 1;
			}
			else if(substr(this.tbMain.tab1.WRK004.Text,0,4) == substr(strlist2,0,4))
			{
				this.tbMain.tab1.WRK004.Value = 1;
			}
		}
		
		var work_etc = ds_PT_UB_USEBEFORE.GetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM_ETC");
	
		var strwork_etc = SubStr(work_etc,0,IndexOf(work_etc,"("));
		
		if(this.tbMain.tab1.WRK002.Text == strwork_etc)
		{
			this.tbMain.tab1.WRK002.Value = 1;
		}
			
		if(IndexOf(work_etc,"(") > 0)
		{
			var strwork_etc = SubStr(work_etc,IndexOf(work_etc,"("),IndexOf(work_etc,")"));
			strwork_etc = strwork_etc.replace("(","").replace(")","");
			var strlist_etc = Split2(strwork_etc+",",",",",");		
			
			for(i = 0; i < Length(strlist_etc); i++)
			{
				var strlist_etc2 = strlist_etc[i].replace("[","").replace("]","");				
				if(this.tbMain.tab1.Checkbox0.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox0.Value = 1;
				}
				else if(this.tbMain.tab1.Checkbox1.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox1.Value = 1;
				}
				else if(this.tbMain.tab1.Checkbox2.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox2.Value = 1;
				}
				else if(this.tbMain.tab1.Checkbox3.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox3.Value = 1;
				}
				
			}
		}
		
		etc = ds_PT_UB_USEBEFORE.GetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM_ETC");

		fnDeficit();
		
		if(scSearch)
		{
			global.MainMenu.Visible = true;
			var arg = "scUSER_ID=" +global.g_User_ID+ " scCAPITAL=" + global.g_Capital +" scLIFT=21";
			Transaction("Lift", "ICCS::left/LeftAction.do?cmd=LeftMgr", "", "gds_menulist=gds_menulist", arg, "fnLiftCallback");
		}				
	}
	
	if(svcid == "UB_CODE")
	{
		ds_PT_UB_USEBEFORE.SetColumn(0,"APPLPER_NM",ds_Usebefore.GetColumn(ds_Usebefore.row,"APPLPER_NM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"APPLPER_REP",ds_Usebefore.GetColumn(ds_Usebefore.row,"APPLPER_REP"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"APPLPER_TELNUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"APPLPER_TELNUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"APPLPER_POSTNUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"APPLPER_POSTNUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"APPLPER_ADDR",ds_Usebefore.GetColumn(ds_Usebefore.row,"APPLPER_ADDR"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"APPLPER_DETAILADDR",ds_Usebefore.GetColumn(ds_Usebefore.row,"APPLPER_DETAILADDR"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OPE_NAME",ds_Usebefore.GetColumn(ds_Usebefore.row,"OPE_NAME"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OPE_TELNUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"OPE_TELNUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OPE_REP",ds_Usebefore.GetColumn(ds_Usebefore.row,"OPE_REP"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"COI_WRT_NUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"COI_WRT_NUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OPE_POSTNUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"OPE_POSTNUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OPE_ADDR",ds_Usebefore.GetColumn(ds_Usebefore.row,"OPE_ADDR"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OPE_DETAILADDR",ds_Usebefore.GetColumn(ds_Usebefore.row,"OPE_DETAILADDR"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OFFI_NM",ds_Usebefore.GetColumn(ds_Usebefore.row,"OFFI_NM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"OFFI_TELNUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"OFFI_TELNUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"SW_DT",ds_Usebefore.GetColumn(ds_Usebefore.row,"SW_DT"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"EW_DT",ds_Usebefore.GetColumn(ds_Usebefore.row,"EW_DT"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"ADMIT_DT",ds_Usebefore.GetColumn(ds_Usebefore.row,"ADMIT_DT"));		
		ds_PT_UB_USEBEFORE.SetColumn(0,"INSP_WISH_YMD",ds_Usebefore.GetColumn(ds_Usebefore.row,"INSP_WISH_YMD"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"PROC_OFFI",ds_Usebefore.GetColumn(ds_Usebefore.row,"PROC_OFFI"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"INSP_FEE",ds_Usebefore.GetColumn(ds_Usebefore.row,"INSP_FEE"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"RECV_DT",ds_Usebefore.GetColumn(ds_Usebefore.row,"RECV_DT"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"PROC_LIM",ds_Usebefore.GetColumn(ds_Usebefore.row,"PROC_LIM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"INSP_SPOT_NM",ds_Usebefore.GetColumn(ds_Usebefore.row,"INSP_SPOT_NM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"INSP_SPOT_POSTNUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"INSP_SPOT_POSTNUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"INSP_SPOT_ADDR",ds_Usebefore.GetColumn(ds_Usebefore.row,"INSP_SPOT_ADDR"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"INSP_SPOT_DETAILADDR",ds_Usebefore.GetColumn(ds_Usebefore.row,"INSP_SPOT_DETAILADDR"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"USE",ds_Usebefore.GetColumn(ds_Usebefore.row,"USE"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"WORK_ITEM",ds_Usebefore.GetColumn(ds_Usebefore.row,"WORK_ITEM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"WORK_ITEM_ETC",ds_Usebefore.GetColumn(ds_Usebefore.row,"WORK_ITEM_ETC"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"AREA",ds_Usebefore.GetColumn(ds_Usebefore.row,"AREA"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"NUM_FL",ds_Usebefore.GetColumn(ds_Usebefore.row,"NUM_FL"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"PLAN_CONFIRM_PER_YN_CONT",ds_Usebefore.GetColumn(ds_Usebefore.row,"PLAN_CONFIRM_PER_YN_CONT"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"PLAN_CONT_CHG_YN_CONT",ds_Usebefore.GetColumn(ds_Usebefore.row,"PLAN_CONT_CHG_YN_CONT"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"PLAN_ENT_CHG_YN_CONT",ds_Usebefore.GetColumn(ds_Usebefore.row,"PLAN_ENT_CHG_YN_CONT"));		
		ds_PT_UB_USEBEFORE.SetColumn(0,"PLAN_CONFIRM_PER_YN",ds_Usebefore.GetColumn(ds_Usebefore.row,"PLAN_CONFIRM_PER_YN"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"PLAN_ENT_CHG_YN",ds_Usebefore.GetColumn(ds_Usebefore.row,"PLAN_ENT_CHG_YN"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"PLAN_CONT_CHG_YN",ds_Usebefore.GetColumn(ds_Usebefore.row,"PLAN_CONT_CHG_YN"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"SW_BEF_REPO_DELINUM",ds_Usebefore.GetColumn(ds_Usebefore.row,"SW_BEF_REPO_DELINUM"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"BEF_PLANER_NAME",ds_Usebefore.GetColumn(ds_Usebefore.row,"BEF_PLANER_NAME"));
		ds_PT_UB_USEBEFORE.SetColumn(0,"REMARK",ds_Usebefore.GetColumn(ds_Usebefore.row,"REMARK"));
	    ds_PT_UB_USEBEFORE.SetColumn(0,"DEFI_YN",ds_Usebefore.GetColumn(ds_Usebefore.row,"DEFI_YN"));

		vales = ds_PT_UB_USEBEFORE.GetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM");
		var strwork = SubStr(vales,0,IndexOf(vales,"/"));
		var strlist = Split2(vales+"/","/","/");
		
		//2009-11-12 앞 4자리까지만 추출해서 비교해서 처리 풀로비교시에 비정상처리되는 경우가 많음
		for(i = 0; i < Length(strlist); i++){
			var strlist2 = strlist[i].replace("[","").replace("]","");
			if(substr(this.tbMain.tab1.WRK001.Text,0,4) == substr(strlist2,0,4))
			{
				this.tbMain.tab1.WRK001.Value = 1;
			}
			else if(substr(this.tbMain.tab1.WRK003.Text,0,4) == substr(strlist2,0,4))
			{
				this.tbMain.tab1.WRK003.Value = 1;
			}
			else if(substr(this.tbMain.tab1.WRK004.Text,0,4) == substr(strlist2,0,4))
			{
				this.tbMain.tab1.WRK004.Value = 1;
			}
		}
		
		var work_etc = ds_PT_UB_USEBEFORE.GetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM_ETC");
	
		var strwork_etc = SubStr(work_etc,0,IndexOf(work_etc,"("));
		
		if(this.tbMain.tab1.WRK002.Text == strwork_etc)
		{
			this.tbMain.tab1.WRK002.Value = 1;
		}
			
		if(IndexOf(work_etc,"(") > 0)
		{
			var strwork_etc = SubStr(work_etc,IndexOf(work_etc,"("),IndexOf(work_etc,")"));
			strwork_etc = strwork_etc.replace("(","").replace(")","");
			var strlist_etc = Split2(strwork_etc+",",",",",");		
			
			for(i = 0; i < Length(strlist_etc); i++)
			{
				var strlist_etc2 = strlist_etc[i].replace("[","").replace("]","");				
				if(this.tbMain.tab1.Checkbox0.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox0.Value = 1;
				}
				else if(this.tbMain.tab1.Checkbox1.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox1.Value = 1;
				}
				else if(this.tbMain.tab1.Checkbox2.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox2.Value = 1;
				}
				else if(this.tbMain.tab1.Checkbox3.Text == strlist_etc2)
				{
					this.tbMain.tab1.Checkbox3.Value = 1;
				}
				
			}
		}
		
		etc = ds_PT_UB_USEBEFORE.GetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM_ETC");

		fnDeficit();
	
	}
	
}


function fnLiftCallback(Svcid, sErrCode, sErrMsg) 
{	
	
	global.MainMenu.Image2.text = gds_menulist.GetColumn(0,"frmtxt");
	g_Titel = gds_menulist.GetColumn(0,"frmtxt");
	fn_subHide();  
	fn_subShow();
	obj = object("global.MainMenu.sub_img1");
	obj.ImageID = "left_menu2_1_on";
	obj.Color = "#FFFFFF";
	
}

//////////////////////////////////////////////////////////////////
// 툴바 버튼 이벤트 핸들러
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnInsert
 2. 기  능 : 신규버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnInsert()
{
	
	fnInitButtonBar();
	ds_PT_UB_USEBEFORE.AddRow();
	fnAllControlState(false, this);
	fnControlState(true, this, "CIV_RECV_NUM,btnCheck");
	this.tbMain.tab1.WRK001.Enable = false;
	this.tbMain.tab1.WRK002.Enable = false;
	this.tbMain.tab1.WRK003.Enable = false;
	this.tbMain.tab1.WRK004.Enable = false;
	
	// 2010.01.13. 검사수수료 기본설정 제거
	// tbMain.tab5.INSP_FEE.Value = "2000";
}


/**
 1. 함수명 : fnModify
 2. 기  능 : 수정버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnModify()
{

	global.gv_WorkFlag = global.gv_MODIFY;
	var sArgs = fnParamInit("",this);
	sArgs += " scRECV_NUM="+scRECV_NUM+" "+base_code;

	var sTid = "GET_CODE";
	var sUrl = "ICCS::ub/UbAction.do?cmd=UBReceiptMgrC";
	var sInDs = "";
	var sOutDs = "ds_PT_UB_USEBEFORE=output dsPT_UB_MEMO=output2 dsPT_R_DEFICIT=output3 dsPT_R_DEFICIT_CODE=output4 dsUSE=output5 dsWORK=output6 dsINSP=output7";
	var sCallBack = "fn_CallBack";
	
	Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);

}

/**
 1. 함수명 : fnRemove
 2. 기  능 : 삭제버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnRemove()
{
	
	
	if(!Confirm('선택하신 내용을 삭제하시겠습니까?')) return;
	
	ds_PT_UB_USEBEFORE.ApplyChange();
	var nCount = fnGridRowRemove(ds_PT_UB_USEBEFORE);
	
	if(nCount == 0)
	{
		alert('삭제할 데이터를 선택하세요.');
		return;
	}
	
	var sArgs = "";	
	var sTid = "DELETE";
	var sUrl = "ICCS::ub/UbAction.do?cmd=UBReceiptMgrCUD";
	var sInDs = "ds_PT_UB_USEBEFORE=ds_PT_UB_USEBEFORE:u";
	var sOutDs = "ds_PT_UB_USEBEFORE=ds_PT_UB_USEBEFORE";
	var sCallBack = "fn_CallBack";
		
	Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
	
	
}

/**
 1. 함수명 : fnSave
 2. 기  능 : 저장버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnSave()
{
    http.timeout = 600;
    
	if (this.tbMain.tab1.WRK001.Value == 0 && this.tbMain.tab1.WRK003.Value == 0){
		ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM","");
	}
	
	fnDefiYN();
	
	if (!fnValidation()) return;
	
	var sArgs = "workMODE=ALL "+base_code;
	var sTid = "save";
	var sUrl = "ICCS::ub/UbAction.do?cmd=UBReceiptMgrCUD";
	var sInDs = "ds_PT_UB_USEBEFORE=ds_PT_UB_USEBEFORE:U dsPT_R_DEFICIT=dsPT_R_DEFICIT:U";
	var sOutDs = "ds_PT_UB_USEBEFORE=output dsPT_R_DEFICIT=output2";
	var sCallBack = "fn_CallBack";
	Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
	
}

function fnCancel()
{
	global.gv_WorkFlag = global.gv_INQUIRY;
	fnInitButtonBar();
}

/**
 1. 함수명 : fnReport
 2. 기  능 : 출력버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnReport()
{
	var sCode = fnCreateDialog("ub::InMgrReportDlg.xml", "");
}

/**
 1. 함수명 : fnExcel
 2. 기  능 : 엑셀버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnExcel()
{	
	fnGridToExcel(grdList, "사용전검사 접수관리");
}


//////////////////////////////////////////////////////////////////
// 툴바 버튼 이벤트
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnToolBarButton_Click
 2. 기  능 : 툴바버튼 이벤트 핸들러
 3. Params 
    없음
 4. Return
    없음
*/
function fnToolBarButton_Click(obj)
{
	if (obj == divButtonBar.btnInsert)
	{
		fnInsert();
	}
	else if (obj == divButtonBar.btnModify)
	{
		fnModify();
	}
	else if (obj == divButtonBar.btnRemove)
	{
		fnRemove();
	}
	else if (obj == divButtonBar.btnSave)
	{
		fnSave();
	}
	else if (obj == divButtonBar.btnReport)
	{
		fnReport();
	}
	else if (obj == divButtonBar.btnExcel)
	{
		fnExcel();
	}
	else if (obj == divButtonBar.btnCancel)
	{
		fnCancel();
	}
	else if (obj == divButtonBar.btnList)
	{
		fnList();
	}
	else
	{
		alert('개발자오류');
	}
}

//////////////////////////////////////////////////////////////////
// 검색 버튼 이벤트
//////////////////////////////////////////////////////////////////
function fnSearchButton_Click(obj)
{
	fnTablesBinding(false);
}

//////////////////////////////////////////////////////////////////
// Key Down 관련 이벤트
//////////////////////////////////////////////////////////////////

function fnKey_Down(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	if(nChar == "81" && bControl == true) fnTablesBinding();
	else if(nChar == "49" && bControl == true) fnInsert();
	else if(nChar == "50" && bControl == true) fnModify();
	else if(nChar == "51" && bControl == true) fnRemove();
	else if(nChar == "83" && bControl == true) fnSave();
	//else if(nChar == "55" && bControl == true) fnSave();
	//else if(nChar == "88" && bControl == true) Close();
	else if(nChar == "80" && bControl == true) fnReport();
	else if(nChar == "13") 
	{
		var sCompnentname = GetCurrentComponent(true);
		if(sCompnentname.GetType() == "TextArea") return;
		GetNextComponent(true).SetFocus();
	}
	else if(nChar == "120") 
	{
		var nTabIndex = tbMain.TabIndex;
		
		if(nTabIndex == tbMain.TabCount - 1)
			tbMain.TabIndex = 0;
		else
			tbMain.TabIndex = nTabIndex + 1;
	}
}

//////////////////////////////////////////////////////////////////
// Grid 관련 이벤트
//////////////////////////////////////////////////////////////////
/**
 1. 함수명 : fnGridDouble_Click
 2. 기  능 : Grid Cell 더블크릭 이벤트 핸들러
 3. Params 
    @obj : 이벤트 오브젝트
    @nRow : 선택된 Row Index
    @nCell : 선택된 Cell Index
    @nX
    @nY
    @nPivotIndex
 4. Return
    없음
*/
function fnGridDouble_Click(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	
}

function fnEditButton_Click(obj)
{
	var _varArray;
	//우편번호 버튼 출력
	
	if (obj == this.tbMain.tab5.btnPostCode1)
	{		
	
		_varArray = fnCreateDialog("bas::PostStD.xml");		
		
		this.tbMain.tab5.APPLPER_POSTNUM = _varArray[0].replace("-","");
		this.tbMain.tab5.APPLPER_ADDR = _varArray[1];
		this.tbMain.tab5.APPLPER_DETAILADDR = _varArray[2];
		this.tbMain.tab5.APPLPER_DETAILADDR.SetFocus();
				
	}
	
	if (obj == this.tbMain.tab1.btnPostCode3)
	{		
		_varArray = fnCreateDialog("bas::PostStD.xml");
		
		this.tbMain.tab1.INSP_SPOT_POSTNUM = _varArray[0].replace("-","");
		this.tbMain.tab1.INSP_SPOT_ADDR = _varArray[1];
		//this.tbMain.tab5.APPLPER_ADDR = _varArray[1];
		this.tbMain.tab1.INSP_SPOT_DETAILADDR = _varArray[2];
		this.tbMain.tab1.INSP_SPOT_DETAILADDR.SetFocus();
	}
	
	if (obj == this.tbMain.tab5.btnOepCode)
	{
		_varArray = fnCreateDialog("bas::CMStD.xml");
		fnEditCMStD(_varArray[1]);
	}
	
	if (obj == this.tbMain.tab1.btnBeForCode)
	{
		var sArgs =  "scTYPE=UB";
		_varArray = fnCreateDialog("ub::BeforeSchMgr.xml",sArgs);
		
		// 2010.01.08. 
		// 디자인소스의 프로퍼티가 Enable이 False로 되어 있으면 값이 안들어간다?
		// 소스코드에서 스크립트로 컨트롤하고 있어 디자인소스에서는 Enable을 True로 변경
		this.tbMain.tab1.SW_BEF_REPO_DELINUM.Text = _varArray[0].replace("[","").replace("]","").replace(",","");
		this.tbMain.tab1.BEF_PLANER_NAME.Text = _varArray[1].replace("[","").replace("]","").replace(",","");

	}
	if (obj == this.tbMain.tab5.btnProcSch)
	{
		_varArray = fnCreateDialog("ub::ProcSchMgr.xml");
		
		this.tbMain.tab5.PROC_OFFI.Text = _varArray[0];
		this.tbMain.tab5.PROC_OFFI_ID.Text = _varArray[3];
	}
	
	if (obj == this.tbMain.tab5.btnReSch)   
	{
	
		_varArray = fnCreateDialog("ub::UsebeforeSchMgr.xml");
		
		fnUbFoSch(_varArray[0]);
		
		
	}
	
	if (obj == this.btnNapplSch)   
	{
	
		_varArray = fnCreateDialog("ub::UsebeforeNapplSchMgr.xml");
		
		fnUbFoSch(_varArray[0]);
		
		
	}
	
	
	
}

function fnUbFoSch(varArray){
	
	var sArgs = "scRECV_NUM="+varArray;
		sArgs += " scSIDO_CODE="+global.g_Sd_cd+" scSIGUNGU_CODE="+global.g_Sgg_cd;
	var sTid = "UB_CODE";
	//var sUrl = "ICCS::ub/UbAction.do?cmd=UsebeforeMgr";
	var sUrl = "ICCS::ub/UbAction.do?cmd=UsebeforeViewMgr";
	var sInDs = "";
	var sOutDs = "ds_Usebefore=output";
	var sCallBack = "fn_CallBack";
	
	Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
}


function fnEditCMStD(varArray){
	var TMP_WRT_NUM = varArray;
	
	var sArgs = "scTMP_WRT_NUM="+TMP_WRT_NUM;
	var sTid = "MASTER_CODE";
	var sUrl = "ICCS::ub/UbAction.do?cmd=UBMasterCodeMgr";
	var sInDs = "";
	var sOutDs = "ds_MASTER=output";
	var sCallBack = "fn_CallBack";
	
	Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
}

function fnNumCode(obj){

	var sArgs = "scCIV_RECV_NUM="+this.CIV_RECV_NUM.Text;
	var sTid = "NUM_CODE";
	var sUrl = "ICCS::ub/UbAction.do?cmd=CheckKeyMgr";
	var sInDs = "";
	var sOutDs = "ds_NUMCHK=output";
	var sCallBack = "fn_CallBack";
	
	if(this.CIV_RECV_NUM.Text == ""){
		alert("접수 번호를 입력 하시기 바랍니다.");
		return;
	}else{
	
		Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
	
	}

}

function fn_Radio_OnClick(obj)
{
	if(obj == this.tbMain.tab1.Radio0){		
			this.tbMain.tab1.PLAN_CONFIRM_PER_YN_CONT.Text = tbMain.tab1.Radio0.Value;		
	}
	
	if(obj == this.tbMain.tab1.Radio1){	
		if (tbMain.tab1.Radio1.Value =="변경"){
			this.tbMain.tab1.PLAN_ENT_CHG_YN_CONT.Text = "["+tbMain.tab1.Radio1.Value+"] 검사신청서 설계업체 : ";
		} else {
			this.tbMain.tab1.PLAN_ENT_CHG_YN_CONT.Text = tbMain.tab1.Radio1.Value;
		}
	}
	
	if(obj == this.tbMain.tab1.Radio2){		
			this.tbMain.tab1.PLAN_CONT_CHG_YN_CONT.Text = tbMain.tab1.Radio2.Value;
	}
	
	
}


/////////////////////////////////////////////////////////////////
// Memo Detail Event
//////////////////////////////////////////////////////////////////
function fnMemoButton_Click(obj)
{
	var sDtWorkFlag;
	
	if(obj == tbMain.tpMemo.btnMemoInsert)
	{
		var sTime = GetDate();
		sDtWorkFlag = global.gv_INSERT;
		dsPT_UB_MEMO.AddRow();
		dsPT_UB_MEMO.SetColumn(dsPT_UB_MEMO.row, "SIDO_CODE", global.g_Sd_cd);
		dsPT_UB_MEMO.SetColumn(dsPT_UB_MEMO.row, "SIGUNGU_CODE", global.g_Sgg_cd);
		dsPT_UB_MEMO.SetColumn(dsPT_UB_MEMO.row, "RECV_NUM", scRECV_NUM);
		dsPT_UB_MEMO.SetColumn(dsPT_UB_MEMO.row, "SEQ", dsPT_UB_MEMO.rowcount);
		dsPT_UB_MEMO.SetColumn(dsPT_UB_MEMO.row, "WRT_NAME", global.g_Name);
		dsPT_UB_MEMO.SetColumn(dsPT_UB_MEMO.row, "WRT_TIME", Mid(sTime, 8, 2) + Mid(sTime, 10, 2));
		dsPT_UB_MEMO.SetColumn(dsPT_UB_MEMO.row, "MEMO_DT", Today());

		fnInitMemoGroup(sDtWorkFlag);
	}
	else if (obj == tbMain.tpMemo.btnMemoModify)
	{
		sDtWorkFlag = global.gv_MODIFY;
		fnInitMemoGroup(sDtWorkFlag);
	}
	else if (obj == tbMain.tpMemo.btnMemoRemove)
	{
		sDtWorkFlag = global.gv_INQUIRY;
		
		dsPT_UB_MEMO.ApplyChange();
		var nCount = fnGridRowRemove(dsPT_UB_MEMO);
		
		if(nCount == 0)
		{
			alert('삭제할 데이터를 선택하세요.');
			return;
		}
		
		var sArgs = "workMODE=MEMO";
		var sTid = "MEMO_DELETE";
		var sUrl = "ICCS::ub/UbAction.do?cmd=UBReceiptMgrCUD";
		var sInDs = "dsPT_UB_MEMO=dsPT_UB_MEMO:u";
		var sOutDs = "dsPT_UB_MEMO=output";
		var sCallBack = "fn_CallBack";
		
		Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
	}
	else if (obj == tbMain.tpMemo.btnMemoCancel)
	{
		if (dsPT_UB_MEMO.GetRowType(dsPT_UB_MEMO.row) == "insert")
			dsPT_UB_MEMO.DeleteRow(dsPT_UB_MEMO.row);
		else
			fnRejectChange(dsPT_UB_MEMO);
		
		sDtWorkFlag = global.gv_INQUIRY;
		fnInitMemoGroup(sDtWorkFlag);
	}
	else if (obj == tbMain.tpMemo.btnMemoSave)
	{
		sDtWorkFlag = global.gv_INQUIRY;
		
		var sArgs = "workMODE=MEMO";	
		var sTid = "MEMO_SAVE";
		var sUrl = "ICCS::ub/UbAction.do?cmd=UBReceiptMgrCUD";
		var sInDs = "dsPT_UB_MEMO=dsPT_UB_MEMO:u";
		var sOutDs = "dsPT_UB_MEMO=output";
		var sCallBack = "fn_CallBack";
		
		Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);
	}
}

function fnInitMemoGroup(sDtWorkFlag)
{
	if(sDtWorkFlag == global.gv_INQUIRY)
	{
		fnControlState(false, tbMain.tpMemo, "MEMO_DT,MEMO_CONTENT,WRT_NAME,WRT_TIME");
		fnControlState(true, tbMain.tpMemo, "grdMemo");
		
		tbMain.tpMemo.btnMemoInsert.Enable = true;
		tbMain.tpMemo.btnMemoModify.Enable = true;
		tbMain.tpMemo.btnMemoRemove.Enable = true;
		tbMain.tpMemo.btnMemoSave.Enable = false;
		tbMain.tpMemo.btnMemoCancel.Enable = false;
	}
	else if(sDtWorkFlag == global.gv_INSERT)
	{
		fnControlState(true, tbMain.tpMemo, "MEMO_DT,MEMO_CONTENT,WRT_NAME,WRT_TIME");
		fnControlState(false, tbMain.tpMemo, "grdMemo");
		
		tbMain.tpMemo.btnMemoInsert.Enable = false;
		tbMain.tpMemo.btnMemoModify.Enable = false;
		tbMain.tpMemo.btnMemoRemove.Enable = false;
		tbMain.tpMemo.btnMemoSave.Enable = true;
		tbMain.tpMemo.btnMemoCancel.Enable = true;
	}
	else if(sDtWorkFlag == global.gv_MODIFY)
	{
		fnControlState(true, tbMain.tpMemo, "MEMO_DT,MEMO_CONTENT,WRT_NAME,WRT_TIME");
		fnControlState(false, tbMain.tpMemo, "grdMemo");
		
		tbMain.tpMemo.btnMemoInsert.Enable = false;
		tbMain.tpMemo.btnMemoModify.Enable = false;
		tbMain.tpMemo.btnMemoRemove.Enable = false;
		tbMain.tpMemo.btnMemoSave.Enable = true;
		tbMain.tpMemo.btnMemoCancel.Enable = true;
	}
}

function fnDCheck_Click(obj)
{

	//var sArgs = "scCIV_RECV_NUM="+this.CIV_RECV_NUM.Text+" "+base_code;
	// 접수번호 14자리 입력으로 정수형으로 넘겼을경우 문제발생하여 문자열로 넘김
	var sArgs = "scCIV_RECV_NUM="+quote(this.CIV_RECV_NUM.Text)+" "+base_code;
	
	// 접수시 기본수수료를 가지고 INSERT
	
	sArgs += " INSP_FEE=" + tbMain.tab5.INSP_FEE.Value;
	
	var sTid = "NUM_CODE";
	var sUrl = "ICCS::ub/UbAction.do?cmd=CheckKeyMgr";
	var sInDs = "";
	var sOutDs = "ds_NUMCHK=output";
	var sCallBack = "fn_CallBack";
	
	if(this.CIV_RECV_NUM.Text == ""){
		alert("접수 번호를 입력 하시기 바랍니다.");
		return;
	}else{
		Transaction(sTid, sUrl, sInDs, sOutDs, sArgs, sCallBack);	
	}
}

function fnToInsert()
{
	fnModify();
}

function fnDeficit()
{	
	var sGroup;
	var nIndex = 0;
	if(dsPT_R_DEFICIT.rowcount == 0){
	
		for(var nLoop = 0; nLoop < dsPT_R_DEFICIT_CODE.rowcount; nLoop++)
		{
			sGroup = dsPT_R_DEFICIT_CODE.GetColumn(nLoop, "DEFI_GROUP");
			
			if (sGroup == "GUBU")
			{  
				dsPT_R_DEFICIT.AddRow();
				dsPT_R_DEFICIT.SetColumn(nIndex, "RECV_NUM", scRECV_NUM);
				dsPT_R_DEFICIT.SetColumn(nIndex, "SIDO_CODE", global.g_Sd_cd); 
				dsPT_R_DEFICIT.SetColumn(nIndex, "DEFI_SEQ", nIndex + 1);
				dsPT_R_DEFICIT.SetColumn(nIndex, "DEFI_CODE", dsPT_R_DEFICIT_CODE.GetColumn(nLoop, "DEFI_CODE"));
				dsPT_R_DEFICIT.SetColumn(nIndex, "DEFI_CONT", dsPT_R_DEFICIT_CODE.GetColumn(nLoop, "CONT"));
				dsPT_R_DEFICIT.SetColumn(nIndex, "DEFI_GROUP", "GUBU");
				
				nIndex++;
			}
		}
	}

	this.tbMain.tab5.PROC_OFFI.Text = global.g_NAME; //성명
	this.tbMain.tab5.PROC_OFFI_ID.Text = global.g_User_ID; //성명

}


function fnDefiYN()
{
	var DEFI_YN = "N";
	var no_cnt = 0;	
	ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row, "DEFI_YN", "");
	
	for(var nLoop = 0; nLoop < dsPT_R_DEFICIT.rowcount; nLoop++)
	{
		if(dsPT_R_DEFICIT.GetColumn(nLoop, "DEFI_OUT") == "1"){
			no_cnt += 1;
		}
	}
	
	if(dsPT_R_DEFICIT.rowcount == no_cnt){
		DEFI_YN = "Y";
	}else{
		DEFI_YN = "N";
	}
	
	ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row, "DEFI_YN", DEFI_YN);
}

function fnLocalGridHead_Click(obj,nCell,nX,nY,nPivotIndex)
{
	var objDs = obj.BindDataset;

	if (object(objDs).RowCount() == 0)
		return;
	 
	if (obj.GetCellProp("head", nCell, "edit") == "checkbox")
	{
		if(obj.GetCellProp("head", nCell, "text") == "1")
		{
			obj.SetCellProp("head", nCell, "text", "0");
			fnSetGridCheck(0, objDs, "DEFI_OUT");
		}
		else
		{
			obj.SetCellProp("head", nCell, "text", "1");
			fnSetGridCheck(1, objDs, "DEFI_OUT");
		}
		
		//object(objDs).ApplyChange();
	}
	else
	{
		var sHeadName = obj.GetCellProp("head", nCell, "text");
		var sColName = obj.GetCellProp("body", nCell, "colid");
		
		if (right(sHeadName, 1) == "↓") 
		{
			object(objDs).Sort(sColName, true);
			obj.SetCellProp("head", nCell, "text", replace(sHeadName, "↓", "↑"));
		}
		else if (right(sHeadName, 1) == "↑") 
		{
			object(objDs).Sort(sColName, false);
			obj.SetCellProp("head", nCell, "text", replace(sHeadName, "↑", "↓"));
		}
		else
		{
			object(objDs).Sort(sColName, true);
			obj.SetCellProp("head", nCell, "text", sHeadName + "↓");
		}
	}
}

function fn_Work_itme(obj,strValue)
{	
	if(strValue == 1)
	{
		if (vales != ""){
			vales = vales + "/"+ obj.Text;
		} else {
			vales += obj.Text+"/";
		}
	}
	else if(strValue == 0)
	{
		if (vales != ""){
			vales = Replace(vales,obj.Text,"");
		} else {
			vales = Replace(vales,obj.Text+"/","");
		}
	}	
	vales = replace(vales,"//","/");
	
	if (vales.substr(0,1) =="/"){
		vales = SubStr(vales,1,Length(vales));
	}
	//ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM",SubStr(vales,0,Length(vales)-1));
	ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM",vales);	
}

function fn_Work_itme_etc(obj,strValue)
{
	
	if(obj.id == "WRK002")
	{
		if(strValue == 1)
		{
			etc = obj.Text;
			this.tbMain.tab1.Checkbox0.Enable = true;
			this.tbMain.tab1.Checkbox1.Enable = true;
			this.tbMain.tab1.Checkbox2.Enable = true;
			this.tbMain.tab1.Checkbox3.Enable = true;
		}
		else if(strValue == 0)
		{
			etc =  "";
			this.tbMain.tab1.Checkbox0.Enable = false;
			this.tbMain.tab1.Checkbox1.Enable = false;
			this.tbMain.tab1.Checkbox2.Enable = false;
			this.tbMain.tab1.Checkbox3.Enable = false;
		}
	}
	else
	{
		if(etc != ""){
			if(IndexOf(etc,"(") < 0){
				etc = etc.replace(",","");
				etc += "(";
			}
			else
			{
				etc += ",";
			}
			
			etc = Split(etc,")");
			etc = etc.replace("[","").replace("]","");
			if(strValue == 1)
			{
				etc += obj.Text+",";
			}
			else if(strValue == 0)
			{
				etc =  Replace(etc,obj.Text+",","");
			}
		}
			
		if(IndexOf(etc,")") < 0)
		{
			etc = etc.replace(",,",",");
			etc = SubStr(etc,0,Length(etc)-1);
			etc += ")";
		}
	}
	
	var fietc = etc.replace(",(","(").replace("(,","(");
	if(SubStr(fietc,0,1) == "/"){
		fietc = SubStr(fietc,1,Length(fietc));
	}
	
	ds_PT_UB_USEBEFORE.SetColumn(ds_PT_UB_USEBEFORE.row,"WORK_ITEM_ETC",fietc);
	
}
/** 기장군청 저장시 무결성 에러 
function fn_OnDeactivate(obj)
{
	if (global.gv_WorkFlag == global.gv_INSERT || global.gv_WorkFlag == global.gv_MODIFY)
	{
		if (!ds_PT_UB_USEBEFORE.GetUpdate()){
			if(!Confirm('입력중인 데이터가 저장되지 않았습니다.\n\n      저장하시겠습니까?')) return;
			http.sync = true;
			fnSave();
		}
	}
}
*//
function fnValidation()
{
	var nIndex = 0;
	dsError.DeleteAll();
	
		
	if(fnEmpty(tbMain.tab5.APPLPER_NM.Text))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "APPLPER_NM");
		dsError.SetColumn(nIndex, "TEXT", "신청인 건축주(또는 사업자명)이 입력되지 않았습니다.");
		
		nIndex++;
	}
	/** 기장군청 저장시 무결성 에러 
	if(fnEmpty(tbMain.tab5.APPLPER_TELNUM.Text))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "APPLPER_TELNUM");
		dsError.SetColumn(nIndex, "TEXT", "신청인 연락처가 입력되지 않았습니다.");
		
		nIndex++;
	}
	*/
	if(fnEmpty(tbMain.tab5.OPE_NAME.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "OPE_NAME");
		dsError.SetColumn(nIndex, "TEXT", "시공자가 입력 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab5.PROC_OFFI.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "PROC_OFFI");
		dsError.SetColumn(nIndex, "TEXT", "처리 담당자가 입력 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab1.INSP_SPOT_ADDR.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "INSP_SPOT_ADDR");
		dsError.SetColumn(nIndex, "TEXT", "시공현장 주소가 입력 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab1.AREA.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "AREA");
		dsError.SetColumn(nIndex, "TEXT", "면적이 입력 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab1.NUM_FL.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "NUM_FL");
		dsError.SetColumn(nIndex, "TEXT", "층수가 입력 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab1.USE.Text))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "USE");
		dsError.SetColumn(nIndex, "TEXT", "용도가 선택 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab5.INSP_FEE.Text) || tbMain.tab5.INSP_FEE.Value == "0")
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "INSP_FEE");
		dsError.SetColumn(nIndex, "TEXT", "검사수수료가 입력 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab1.SW_BEF_REPO_DELINUM.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "SW_BEF_REPO_DELINUM");
		dsError.SetColumn(nIndex, "TEXT", "착공전설계도 교부번호가 입력 되지 않았습니다.");
		
		nIndex++;
	}
	
	if(fnEmpty(tbMain.tab5.OFFI_NM.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "OFFI_NM");
		dsError.SetColumn(nIndex, "TEXT", "시공자 담당자명이 입력 되지 않았습니다.");
		
		nIndex++;
	}
	/** 기장군청 저장시 무결성 에러 
	if(fnEmpty(tbMain.tab5.OFFI_TELNUM.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "OFFI_TELNUM");
		dsError.SetColumn(nIndex, "TEXT", "시공자 담당자연락처가 입력 되지 않았습니다.");
		
		nIndex++;
	}
	*/
	if(fnEmpty(tbMain.tab5.PROC_OFFI.Value))
	{
		dsError.AddRow();
		dsError.SetColumn(nIndex, "FLD_NAME", "PROC_OFFI");
		dsError.SetColumn(nIndex, "TEXT", "기타사항 처리담당자명이 입력 되지 않았습니다.");
		
		nIndex++;
	}
	

	//var nErrCnt = 0;
	for(var nLoop = 0; nLoop < dsPT_R_DEFICIT.rowcount; nLoop++)
	{
		if(dsPT_R_DEFICIT.GetColumn(nLoop, "DEFI_OUT") != "1")
		{
			//nErrCnt++;
			dsError.AddRow();
			dsError.SetColumn(nIndex, "FLD_NAME", "grdPaper");
			dsError.SetColumn(nIndex, "TEXT", "흠결이 완료되지 않았습니다.");
			nIndex++;
			break;
		}
	}
	
	if (nIndex > 0)
	{
		var nRet = fnCreateDialog("ub::frmErrorDLG.xml", "");
		if (nRet < 0) return true;
		else 
		{
			fnFindComponent(this, dsError.GetColumn(nRet, "FLD_NAME"));
			return false;
		}
	}
	
	return true;
}


function fn_procMgr(obj,strOldText,strText)
{
	var USEBEF_INSP = dsINSP.GetColumn(0,"USEBEF_INSP");
	var data = (ParseInt(strText)+ParseInt(USEBEF_INSP)) ;
	this.tbMain.tab5.PROC_LIM.Value = AddDate(data);
}

/**
 * 재검사 버튼 클릭시 수수료 제어.
**/
function CHG_INSP_OnClick(obj,strValue)
{
//alert(tbMain.tab5.CHG_INSP.Value);
  if (!fnEmpty(tbMain.tab5.INSP_FEE.Value))
  {
    if(tbMain.tab5.CHG_INSP.Value=1)
    {
      var aa=tbMain.tab5.INSP_FEE.Value;
      var scINSP_FEE=ToNumber(aa);
      var bb=2;

      tbMain.tab5.INSP_FEE.Value=(scINSP_FEE/bb);
    }
  }
}

/**
 * 건축주  주소값 가져오기
**/
function fnOPE_Addr_Get_Click(obj,strValue)
{
	if (strValue == 1){
		this.tbMain.tab1.INSP_SPOT_NM 			= this.tbMain.tab5.APPLPER_NM;
		this.tbMain.tab1.INSP_SPOT_POSTNUM = this.tbMain.tab5.APPLPER_POSTNUM;
		this.tbMain.tab1.INSP_SPOT_ADDR = this.tbMain.tab5.APPLPER_ADDR;
		this.tbMain.tab1.INSP_SPOT_DETAILADDR = this.tbMain.tab5.APPLPER_DETAILADDR;
	} else {
		this.tbMain.tab1.INSP_SPOT_NM			= "";
		this.tbMain.tab1.INSP_SPOT_POSTNUM = "";
		this.tbMain.tab1.INSP_SPOT_ADDR = "";
		this.tbMain.tab1.INSP_SPOT_DETAILADDR = "";
	}
}

//////////////////////////////////////////////////////////////////
//리스트 이동
//////////////////////////////////////////////////////////////////
function fnList(){
	var sArgs = fnSearchInit("pSIDO_CODE,pSIGUNGU_CODE,pscCIV_RECV_NUM,pscAPPLPER_NM,pscOPE_NAME,pscRECV_ST,pscRECV_ET,pscFINISH");
	sArgs += " pscMODE=T ";
	gfnCreateNewWindow("ub::UBReceiptMgr", "ub::UBReceiptMgr.xml", sArgs);
}
function Chk_Hid_OnClick(obj,strValue)
{
		
		if (strValue == 1){		
			fnControlState(true, this.tbMain.tab5, "OPE_NAME,OPE_POSTNUM,OPE_ADDR,OPE_DETAILADDR,OPE_REP,OPE_TELNUM,COI_WRT_NUM");
		} else {
			fnControlState(false, this.tbMain.tab5, "OPE_NAME,OPE_POSTNUM,OPE_ADDR,OPE_DETAILADDR,OPE_REP,OPE_TELNUM,COI_WRT_NUM");
		}
}

function tbMain_tab5_RECV_DT_OnChanged(obj,strOldText,strNewText)
{

var USEBEF_INSP = dsINSP.GetColumn(0,"USEBEF_INSP");
var WEEKCHK = dsINSP.GetColumn(0,"WEEKCHK");
var INSTODAY = dsINSP.GetColumn(0,"INSTODAY");
//alert("USEBEF_INSP "+USEBEF_INSP+" WEEKCHK"+WEEKCHK+" INSTODAY"+INSTODAY);
	//seokgon 2010-10-05 수정 		 
	  	if(USEBEF_INSP==null)
    	{
      	tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,14,0,"add");	
    	}
    	else{
      	tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,USEBEF_INSP,WEEKCHK,INSTODAY);	
		}
	//tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,USEBEF_INSP,WEEKCHK,INSTODAY);		
}

function fnKillFocus(obj)
{
	if (obj == tbMain.tab5.RECV_DT)
	{
	
	var USEBEF_INSP = dsINSP.GetColumn(0,"USEBEF_INSP");
    var WEEKCHK = dsINSP.GetColumn(0,"WEEKCHK");
    var INSTODAY = dsINSP.GetColumn(0,"INSTODAY");
//alert("USEBEF_INSP "+USEBEF_INSP+" WEEKCHK"+WEEKCHK+" INSTODAY"+INSTODAY);
  	if(USEBEF_INSP==null)
    	{
    	
      	tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,14,0,"add");	
    	}
    	else{
    	
      	tbMain.tab5.PROC_LIM.Value = fromDayAfter(tbMain.tab5.RECV_DT.Value,USEBEF_INSP,WEEKCHK,INSTODAY);	
		}
		
	}
}


function tbMain_tab5_AREA_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if(nChar == 13)
  {
     
     var aa=tbMain.tab5.AREA.Value;
     var scAREA=ToNumber(aa);

     a=3300;
     b=1000;
     c=500;
      
     
     if(scAREA>=a)
      {
         //alert("6만원");
         if (fnEmpty(tbMain.tab5.INSP_FEE.Value)||tbMain.tab5.INSP_FEE.Value ='0'){
         tbMain.tab5.INSP_FEE.Value=60000;
         }
      }
     else if(scAREA>=b)
      {
     
         //alert("4만원");
         if (fnEmpty(tbMain.tab5.INSP_FEE.Value)||tbMain.tab5.INSP_FEE.Value ='0'){
         tbMain.tab5.INSP_FEE.Value=40000;
         }
      }
      else if(scAREA>=c)
      {
      
        // alert("3만원");
         if (fnEmpty(tbMain.tab5.INSP_FEE.Value)||tbMain.tab5.INSP_FEE.Value ='0'){
         tbMain.tab5.INSP_FEE.Value=30000;
         }
      }
      else 
      {
         //alert("2만원");
         if (fnEmpty(tbMain.tab5.INSP_FEE.Value)||tbMain.tab5.INSP_FEE.Value ='0'){
         tbMain.tab5.INSP_FEE.Value=20000;
         }
         
      }
    
  }
}

function tbMain_tab1_USE_ETC_OnKillFocus(obj)
{
				if (fnEmpty(ds_PT_UB_USEBEFORE.GetColumn(0, "USE")))
		{
			var sMsg = "용도가 입력되지 않았습니다.";
			alert(sMsg);
			tbMain.tab1.USE.SetFocus();
			return;		
		}
}
]]></Script>
</Window>